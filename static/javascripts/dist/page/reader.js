define("nireader/nireader-fe/2.0.0/page/reader",["../module/stateManager","../kit/url","../kit/customEvent","../module/page","../module/createContent","../content/home","../kit/resource","../kit/request","../kit/cache","../kit/local","../config","../interface/index","../kit/notice","../template/common/notice","../template/template","../kit/time","../kit/num","../kit/userinfo","../kit/cookie","../kit/eventList","../template/home/title","../template/home/info","../template/home/subscriptionList","../template/home/recommendList","../template/home/channelInfo","../content/entrance","../content/channel","../template/channel/title","../template/channel/info","../template/channel/itemList","../content/item","../template/item/title","../template/item/info","../template/item/content","../template/item/channelTitle","../kit/testScroll","../module/floater","../kit/keypress","../kit/pattern","../template/common/result","../template/common/tip","../template/common/loadingIcon"],function(a,b,c){var d=a("../module/stateManager"),e=a("../module/page");a("../module/floater");var f=function(){d.on("checkout",function(a){e.checkout(a)})};c.exports={name:"reader",init:f}}),define("nireader/nireader-fe/2.0.0/module/stateManager",["nireader/nireader-fe/2.0.0/kit/url","nireader/nireader-fe/2.0.0/kit/customEvent"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/kit/url").format,e=a("nireader/nireader-fe/2.0.0/kit/customEvent"),f=function(){this.handlers={},this.init()};f.prototype.init=function(){this.bindEvent()},f.prototype.bindEvent=function(){var a=this,b=function(b){b=d(b),a.pushState({url:b,title:"Loading"}),a.checkout()};$("body").delegate("[data-link-async]","click",function(a){var c=$(this);return c.attr("disabled")||!c.attr("href")?!1:(a.ctrlKey||(a.preventDefault(),b(c.attr("href"))),void 0)}),e.on("goto",b),window.onpopstate=function(){a.checkout()}},f.prototype.pushState=function(a){history.pushState(a,a.title,a.url)},f.prototype.checkout=function(){this.trigger("checkout")},f.prototype.on=function(a,b){this.handlers[a]=this.handlers[a]||[],this.handlers[a].push(b)},f.prototype.trigger=function(a){var b=this.handlers[a],c=Array.prototype.slice.call(arguments,1);if(b)for(var d=0,e=b.length;e>d;d++)try{b[d].apply(this,c)}catch(f){console.warn(f),console.log(f.stack)}},c.exports=new f}),define("nireader/nireader-fe/2.0.0/kit/url",[],function(a,b){var c=function(a){var b=a.indexOf("://");return 0>b?a:(a=a.slice(b+3),b=a.indexOf("/"),0>b?"/":a.slice(b))},d=function(a){return a.indexOf("/")?location.pathname.replace(/([\w\d\_]*)$/,a):a},e=function(a){return a?(a=c(a),a=d(a)):null},f=function(a){var b=/\/([\w]*)(\/([\w]+))?($|\?|\#)/,c={};if(b.test(a)){var d=b.exec(a);c.type=d[1],d[3]&&(c.id=parseInt(d[3],10))}return c},g=function(a){return a.indexOf("://")<0?!0:0===a.indexOf(location.origin)?!0:!1};b.format=e,b.parse=f,b.isSameDomain=g}),define("nireader/nireader-fe/2.0.0/kit/customEvent",[],function(a,b,c){var d={};c.exports={on:function(a,b){var c=d[a]=d[a]||[];c.indexOf(b)>=0||c.push(b)},off:function(a,b){var c,e;(c=d[a])&&(e=c.indexOf(b))>=0&&c.splice(e,1)},trigger:function(a){var b;if(b=d[a])for(var c=0,e=b.length;e>c;c++)try{b[c].apply(null,Array.prototype.slice.call(arguments,1))}catch(f){console.log(f.stack)}}}}),define("nireader/nireader-fe/2.0.0/module/page",["nireader/nireader-fe/2.0.0/module/createContent","nireader/nireader-fe/2.0.0/kit/url","nireader/nireader-fe/2.0.0/content/home","nireader/nireader-fe/2.0.0/kit/resource","nireader/nireader-fe/2.0.0/kit/request","nireader/nireader-fe/2.0.0/kit/cache","nireader/nireader-fe/2.0.0/kit/local","nireader/nireader-fe/2.0.0/config","nireader/nireader-fe/2.0.0/interface/index","nireader/nireader-fe/2.0.0/kit/notice","nireader/nireader-fe/2.0.0/template/common/notice","nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num","nireader/nireader-fe/2.0.0/kit/userinfo","nireader/nireader-fe/2.0.0/kit/cookie","nireader/nireader-fe/2.0.0/kit/eventList","nireader/nireader-fe/2.0.0/kit/customEvent","nireader/nireader-fe/2.0.0/template/home/title","nireader/nireader-fe/2.0.0/template/home/info","nireader/nireader-fe/2.0.0/template/home/subscriptionList","nireader/nireader-fe/2.0.0/template/home/recommendList","nireader/nireader-fe/2.0.0/template/home/channelInfo","nireader/nireader-fe/2.0.0/content/entrance","nireader/nireader-fe/2.0.0/content/channel","nireader/nireader-fe/2.0.0/template/channel/title","nireader/nireader-fe/2.0.0/template/channel/info","nireader/nireader-fe/2.0.0/template/channel/itemList","nireader/nireader-fe/2.0.0/content/item","nireader/nireader-fe/2.0.0/template/item/title","nireader/nireader-fe/2.0.0/template/item/info","nireader/nireader-fe/2.0.0/template/item/content","nireader/nireader-fe/2.0.0/template/item/channelTitle","nireader/nireader-fe/2.0.0/kit/testScroll"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/module/createContent"),e=a("nireader/nireader-fe/2.0.0/kit/url"),f=a("nireader/nireader-fe/2.0.0/kit/notice"),g={wrapper:$("#body"),middleBlock:$("#middle-block")};g.getUrl=function(){this.url=e.format(location.href)},g.initContent=function(){this.content=d({url:this.url,wrapper:this.wrapper}),this.content.init()},g.init=function(){this.getUrl(),this.initContent(),this.middleBlock.animate({scrollTop:0},300)},g.clean=function(){f.clean(),this.content&&this.content.clean(),this.content=null},g.checkout=function(){var a=this;a.clean(),setTimeout(function(){a.init()},0)},c.exports=g}),define("nireader/nireader-fe/2.0.0/module/createContent",["nireader/nireader-fe/2.0.0/kit/url","nireader/nireader-fe/2.0.0/content/home","nireader/nireader-fe/2.0.0/kit/resource","nireader/nireader-fe/2.0.0/kit/request","nireader/nireader-fe/2.0.0/kit/cache","nireader/nireader-fe/2.0.0/kit/local","nireader/nireader-fe/2.0.0/config","nireader/nireader-fe/2.0.0/interface/index","nireader/nireader-fe/2.0.0/kit/notice","nireader/nireader-fe/2.0.0/template/common/notice","nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num","nireader/nireader-fe/2.0.0/kit/userinfo","nireader/nireader-fe/2.0.0/kit/cookie","nireader/nireader-fe/2.0.0/kit/eventList","nireader/nireader-fe/2.0.0/kit/customEvent","nireader/nireader-fe/2.0.0/template/home/title","nireader/nireader-fe/2.0.0/template/home/info","nireader/nireader-fe/2.0.0/template/home/subscriptionList","nireader/nireader-fe/2.0.0/template/home/recommendList","nireader/nireader-fe/2.0.0/template/home/channelInfo","nireader/nireader-fe/2.0.0/content/entrance","nireader/nireader-fe/2.0.0/content/channel","nireader/nireader-fe/2.0.0/template/channel/title","nireader/nireader-fe/2.0.0/template/channel/info","nireader/nireader-fe/2.0.0/template/channel/itemList","nireader/nireader-fe/2.0.0/content/item","nireader/nireader-fe/2.0.0/template/item/title","nireader/nireader-fe/2.0.0/template/item/info","nireader/nireader-fe/2.0.0/template/item/content","nireader/nireader-fe/2.0.0/template/item/channelTitle","nireader/nireader-fe/2.0.0/kit/testScroll"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/kit/url"),e={home:a("nireader/nireader-fe/2.0.0/content/home"),welcome:a("nireader/nireader-fe/2.0.0/content/entrance"),channel:a("nireader/nireader-fe/2.0.0/content/channel"),item:a("nireader/nireader-fe/2.0.0/content/item")},f=function(a){var b=a.type||d.parse(a.url).type||"home",c=e[b];return c?new c(a):null};c.exports=f}),define("nireader/nireader-fe/2.0.0/content/home",["nireader/nireader-fe/2.0.0/kit/resource","nireader/nireader-fe/2.0.0/kit/request","nireader/nireader-fe/2.0.0/kit/cache","nireader/nireader-fe/2.0.0/kit/local","nireader/nireader-fe/2.0.0/config","nireader/nireader-fe/2.0.0/kit/url","nireader/nireader-fe/2.0.0/interface/index","nireader/nireader-fe/2.0.0/kit/notice","nireader/nireader-fe/2.0.0/template/common/notice","nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num","nireader/nireader-fe/2.0.0/kit/userinfo","nireader/nireader-fe/2.0.0/kit/cookie","nireader/nireader-fe/2.0.0/kit/eventList","nireader/nireader-fe/2.0.0/kit/customEvent","nireader/nireader-fe/2.0.0/template/home/title","nireader/nireader-fe/2.0.0/template/home/info","nireader/nireader-fe/2.0.0/template/home/subscriptionList","nireader/nireader-fe/2.0.0/template/home/recommendList","nireader/nireader-fe/2.0.0/template/home/channelInfo"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/kit/resource"),e=a("nireader/nireader-fe/2.0.0/kit/request"),f=a("nireader/nireader-fe/2.0.0/kit/notice").notice,g=a("nireader/nireader-fe/2.0.0/kit/userinfo"),h=a("nireader/nireader-fe/2.0.0/kit/eventList"),i=a("nireader/nireader-fe/2.0.0/kit/customEvent"),j=a("nireader/nireader-fe/2.0.0/interface/index"),k=j.api,l=j.page,m=a("nireader/nireader-fe/2.0.0/template/home/title"),n=a("nireader/nireader-fe/2.0.0/template/home/info"),o=a("nireader/nireader-fe/2.0.0/template/home/subscriptionList"),p=a("nireader/nireader-fe/2.0.0/template/home/recommendList"),q=a("nireader/nireader-fe/2.0.0/template/home/channelInfo"),r=$("title"),s=function(a){this.url=a.url,this.wrapper=a.wrapper,this.eventList=h.create("content/home"),this.type="home"};s.prototype.init=function(){g.isLogin(function(a){a||(location.href=l.entrance)}),this.prepareInfo(),this.initDoms(),this.getAllSubscriptionList(),this.getRecommendList(),this.getUserInfo(),this.dealLinks(),this.bindEvent()},s.prototype.bindEvent=function(){var a=this;this.eventList.add(i,"userInfoUpdate",function(){a.refreshSubscriptionList()})},s.prototype.clean=function(){this.eventList.clean(),this.doms.sideContent.html(""),this.doms.sideBlock.clearQueue().stop().hide(),this.doms.leftLink.attr("href","").show(),this.doms.rightLink.attr("href","").show(),this.doms.topLink.attr("href","").show()},s.prototype.prepareInfo=function(){var a=this;a.data={},a.doms={wrapper:a.wrapper,middleBlock:a.wrapper.find("#middle-block"),title:a.wrapper.find("#title"),info:a.wrapper.find("#info"),content:a.wrapper.find("#content"),sideBlock:a.wrapper.find("#side-block"),sideContent:a.wrapper.find("#side-content"),leftLink:a.wrapper.find("#left-link"),rightLink:a.wrapper.find("#right-link"),topLink:a.wrapper.find("#top-link")},a.sideBlock=a.genSideBlock()},s.prototype.initDoms=function(){},s.prototype.genSideBlock=function(){var a,b=this,c=b.doms.middleBlock,g=b.doms.sideBlock,h=b.doms.sideContent,i=function(){g.addClass("loading")},j=function(a){g.removeClass("loading"),h.html(a)},l=function(a){var b=a.offset().top+c.scrollTop(),d=parseInt(g.css("top"),10);g.stop().clearQueue().show().delay(200).animate({top:(6*b-d)/5},100).animate({top:b},50)},m=function(){a=setTimeout(function(){g.hide()},200)},n=function(){a&&(a=clearTimeout(a))},o=function(a,c){c.addClass("icon-spinner icon-spin"),e.post({subscribee:a},k.subscription.add,function(a){c.removeClass("icon-spinner icon-spin"),a?(f("没订阅成"),LOG(a)):(c.addClass("icon-eye-open").removeClass("icon-eye-close"),b.refreshSubscriptionList())})},p=function(a,c){c.addClass("icon-spinner icon-spin"),e.post({subscribee:a},k.subscription.remove,function(a){c.removeClass("icon-spinner icon-spin"),a?(f("没能取消订阅"),LOG(a)):(c.addClass("icon-eye-close").removeClass("icon-eye-open"),b.refreshSubscriptionList(),m())})},r=function(a){var c=g.find("#channel-subscribed");b.eventList.add(c,"click",function(){(c.hasClass("icon-eye-open")?p:o)(a,c)})},s=function(){n();var a=$(this),c=a.attr("data-id");g.attr("data-cid",c),l(a),i(),d.get("channel",{id:c},function(a,d){if(g.attr("data-cid")==c){if(a)return j("Get channel info failed."),void 0;for(var e=b.data.subscriptions.length-1;e>=0;e--)if(b.data.subscriptions[e].id==d.id){d.subscribed=!0;break}j(q({channel:d})),r(c)}})},t=function(a){b.eventList.add(a.find(".item"),"mouseenter",s),b.eventList.add(a,"mouseleave",m)};return b.eventList.add(g,"mouseenter",n),b.eventList.add(g,"mouseleave",m),{bind:t}},s.prototype.getUserInfo=function(){var a=this;d.get("user",{},function(b,c){return b?(console.error(b||"Can not get user info."),void 0):(a.dealUserInfo(c),void 0)})},s.prototype.dealUserInfo=function(a){this.data.user=a,this.renderHomeInfo({user:a})},s.prototype.dealLinks=function(){this.doms.topLink.hide(),this.doms.leftLink.hide(),this.doms.rightLink.hide()},s.prototype.getSubscriptionListByPage=function(a){var b=this;d.makeList("subscription",null,function(c,d){return c?(console.error(c),void 0):(b.data.subscriptionListPage=a,b.dealSubscriptionList(d),void 0)})(a)},s.prototype.getAllSubscriptionList=function(a){var b=this;d.makeList("subscription",null,function(a,c){return a?(console.error(a),void 0):(b.dealSubscriptionList(c),void 0)},null,null,a)()},s.prototype.refreshSubscriptionList=function(){this.doms.subscriptionList&&this.doms.subscriptionList.remove(),this.getAllSubscriptionList(!0)},s.prototype.dealSubscriptionList=function(a){a.map(function(a){return a.pageUrl=l.myChannel(a.id),a}),this.data.subscriptions=a,this.renderSubscriptionList({subscriptions:a})},s.prototype.getRecommendList=function(){var a=this;d.makeList("channel",null,function(b,c){return b?(console.error(b),void 0):(a.dealRecommendList(c),void 0)},{order:"score",descrease:!0})(1)},s.prototype.dealRecommendList=function(a){a.map(function(a){return a.pageUrl=l.recommendChannel(a.id),a}),this.data.recommends=a,this.renderRecommendList({recommends:a})},s.prototype.renderHomeInfo=function(a){r.text(a.user.name+"'s reader"),this.doms.title.html(m(a)),this.doms.info.html(n(a))},s.prototype.renderSubscriptionList=function(a){this.recommendListReady?this.doms.content.prepend(o(a)):this.doms.content.html(o(a)),this.subscriptionListReady=!0,this.doms.subscriptionList=this.doms.content.find("#subscription-list"),this.sideBlock.bind(this.doms.subscriptionList)},s.prototype.renderRecommendList=function(a){this.subscriptionListReady?this.doms.content.append(p(a)):this.doms.content.html(p(a)),this.recommendListReady=!0,this.doms.recommendList=this.doms.content.find("#recommend-list"),this.sideBlock.bind(this.doms.recommendList)},c.exports=s}),define("nireader/nireader-fe/2.0.0/kit/resource",["nireader/nireader-fe/2.0.0/kit/request","nireader/nireader-fe/2.0.0/kit/cache","nireader/nireader-fe/2.0.0/kit/local","nireader/nireader-fe/2.0.0/config","nireader/nireader-fe/2.0.0/kit/url","nireader/nireader-fe/2.0.0/interface/index"],function(a,b){var c=a("nireader/nireader-fe/2.0.0/kit/request"),d=a("nireader/nireader-fe/2.0.0/kit/cache");a("nireader/nireader-fe/2.0.0/kit/url").format;var e=a("nireader/nireader-fe/2.0.0/interface/index").api,f=a("nireader/nireader-fe/2.0.0/config").resource,g=f.lifetime,h={item:e.item.get,channel:e.channel.get,user:e.user.get},i={item:{order:"pubDate",descrease:!0},channel:{order:"id",descrease:!1},user:{order:"name",descrease:!1}},j=function(a,b,e,f){if(a&&"string"==typeof a){var j={cache:"resource",type:a,opt:b,sort:f},k={opt:b,sort:f||i[a]},l=h[a];c.get(k,l,function(a,b){a||d.set(j,b,g.resource),e&&e(a,b)})}},k=function(a,b,e,f,j){if(a&&"string"==typeof a){var k,l={cache:"resource",type:a,opt:b,sort:f};if(!j&&(k=d.get(l)))return e&&e(null,k),void 0;var m={opt:b,sort:f||i[a]},n=h[a];c.get(m,n,function(a,b){a||d.set(l,b,g.resource),e&&e(a,b)})}},l={item:e.item.list,channel:e.channel.list,subscription:e.subscription.list},m={item:["id","pubDate","title","source"],channel:["id","pubDate","title"],subscription:["channel.id","channel.pubDate","channel.title"]},n={item:{order:"pubDate",descrease:!0},channel:{order:"id",descrease:!1},subscription:{order:"channel.id",descrease:!1}},o={item:20,channel:20,subscription:20},p=function(a,b,e,f,h,i,j){if(a&&"string"==typeof a){var k,p={cache:"list",type:a,opt:b,sort:h};if(!j&&(k=d.get(p)))return f&&f(null,k),void 0;var q,r=o[a];q=e?"object"==typeof e?e:r?{from:r*(e-1),num:r}:null:null;var s={opt:b,fields:i||m[a],sort:h||n[a],limit:q},t=l[a];c.get(s,t,function(a,b){a||d.set(p,b,g.list),f&&f(a,b)})}},q=function(a,b,c,d,e,f){return function(g){return p(a,b,g,c,d,e,f)}},r={item:e.item.search,channel:e.channel.search,subscription:e.subscription.search},s=function(a,b,d,e,f,g){if(a&&"string"==typeof a){var h,i=o[a];"object"==typeof d&&(h=d);var j={keywords:b,fields:g||m[a],sort:f||n[a],limit:h||(i?{from:i*(d-1),num:i}:null)},k=r[a];c.get(j,k,e)}},t=function(a,b,c,d,e){return function(f){return s(a,b,f,c,d,e)}};b.refresh=j,b.get=k,b.list=p,b.search=s,b.makeList=q,b.makeSearch=t}),define("nireader/nireader-fe/2.0.0/kit/request",[],function(a,b){var c=3,d=function(a,b,e,f,g){"string"==typeof b&&(g=f,f=e,e=b,b=null),$.ajax(e,{data:b,type:a,dataType:"json",headers:{isAjax:!0},success:function(a){f&&f(a.err,a.data)},error:function(h){g===!0&&(g=c),"number"==typeof g&&g>0?d(a,b,e,f,--g):f&&f(h,null)}})};b.post=function(a,b,c,e){d("post",a,b,c,e)},b.get=function(a,b,c,e){d("get",a,b,c,e)}}),define("nireader/nireader-fe/2.0.0/kit/cache",["nireader/nireader-fe/2.0.0/kit/local","nireader/nireader-fe/2.0.0/config"],function(a,b,c){var d,e=a("nireader/nireader-fe/2.0.0/kit/local").create("cache"),f=a("nireader/nireader-fe/2.0.0/config").cache,g=f.manageInterval,h=f.lifetime,i=f.maxNum,j={},k=[],l=function(){window.LOG.apply(window,arguments),d&&clearTimeout(d),d=setTimeout(function(){window.LOG("storage: ",j,"hotList: ",k),d=null},10)},m=function(a,b){var c=k.indexOf(a);c>=0&&k.splice(c,1),b||k.push(a)},n=function(a,b,c){a=JSON.stringify(a),b=JSON.stringify(b),m(a),l("cache: ",a),j[a]={cnt:b,doom:Date.now()+(c||h)}},o=function(a){a=JSON.stringify(a);var b=j[a];return l((b?"catch":"miss")+" in cache: ",a),b?(m(a),JSON.parse(b.cnt)):void 0},p=function(){LOG("save to local begin: ",j),e.clear();for(var a in j)j.hasOwnProperty(a)&&e.set(a,JSON.stringify(j[a]));LOG("save to local: ",j),setTimeout(function(){LOG("local size: ",e.getSize())},100)},q=function(){LOG("load from local begin: ",j);var a,b=e.getAll(),c=Date.now();for(var d in b)b.hasOwnProperty(d)&&(a=JSON.parse(b[d]),c<a.doom&&(j[d]=a));LOG("load from local: ",j)};window.storage=j,window.local=e;var r=function(){l("manage cache...");var a=Date.now();for(var b in j)j.hasOwnProperty(b)&&a>j[b].doom&&(m(b,!0),l("cache expired: ",b),delete j[b]);for(var b,c=k.length-i,d=0;c>d;d++)b=k[d],l("cache over num: ",b),delete j[b];k=k.slice(c,k.length),l("manage cache end."),p()},s=function(){setInterval(r,g)};q(),s(),c.exports={set:n,get:o}}),define("nireader/nireader-fe/2.0.0/kit/local",[],function(a,b,c){var d=function(a,b){return b+"$"+a},e=function(a,b){return a.slice(b.length+1)},f=function(a,b){return!b||0===a.indexOf(b+"$")},g=function(a,b,c){b=d(b,a);try{return localStorage[b]=c}catch(e){return LOG("set localStorage error: ",e),null}},h=function(a,b){return b=d(b,a),localStorage[b]},i=function(a,b){b=d(b,a),localStorage.removeItem(b)},j=function(a){for(var b,c,d={},g=0,h=localStorage.length;h>g;g++)b=localStorage.key(g),b&&f(b,a)&&(c=localStorage[b],d[e(b,a)]=c);return d},k=function(a){for(var b,c=localStorage.length-1;c>=0;c--)b=localStorage.key(c),b&&f(b,a)&&localStorage.removeItem(b)},l=function(a){for(var b,c,d=0,e=0,g=localStorage.length;g>e;e++)b=localStorage.key(e),b&&f(b,a)&&(c=localStorage[b],d+=b.length+c.length);var h=2*d,i=h/1024,j=i/1024;return{length:d,B:h,KB:i.toFixed(2),MB:j.toFixed(2)}},m=function(a){return{get:function(b){return h(a,b)},remove:function(b){return i(a,b)},set:function(b,c){return g(a,b,c)},getAll:function(){return j(a)},clear:function(){return k(a)},getSize:function(){return l(a)}}};c.exports={create:m}}),define("nireader/nireader-fe/2.0.0/config",[],function(a,b,c){c.exports={cache:{manageInterval:6e4,lifetime:6e4,maxNum:100},resource:{lifetime:{resource:36e5,list:6e4}}}}),define("nireader/nireader-fe/2.0.0/interface/index",[],function(a,b,c){var d={channel:{get:"/api/channel",list:"/api/list/channel",search:"/api/search/channel",create:"/api/channel/create",save:"/api/channel/save",vote:"/api/channel/vote"},item:{get:"/api/item",list:"/api/list/item",search:"/api/search/item"},subscription:{get:"/api/subscription",list:"/api/list/subscription",add:"/api/subscription/add",remove:"/api/subscription/remove"},user:{get:"/api/user"},auth:{"in":"/api/signin",out:"/api/signout"}},e={home:"/",entrance:"/welcome",channel:function(a){return"/channel/"+a},item:function(a){return"/item/"+a},myChannel:function(a){return"/my/channel/"+a},myItem:function(a){return"/my/item/"+a},recommendChannel:function(a){return"/recommend/channel/"+a},recommendItem:function(a){return"/recommend/item/"+a}};c.exports={api:d,page:e}}),define("nireader/nireader-fe/2.0.0/kit/notice",["nireader/nireader-fe/2.0.0/template/common/notice","nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/common/notice"),e=$("#notice"),f=$("#body"),g=$("#header"),h=$("#floater"),i=function(){f.addClass("blur"),g.addClass("blur"),h.addClass("blur"),e.show()},j=function(){f.removeClass("blur"),g.removeClass("blur"),h.removeClass("blur"),e.hide()},k=function(){e.html("")},l=function(a){"object"==typeof a&&(a=JSON.stringify(a));var b={word:a};e.html(d({notice:b})),i()},m=function(a){e.find("#confirm").on("click",function(){j(),a&&a()})},n=function(a,b){l(a),m(b)},o=function(){k(),j()};c.exports={clean:o,notice:n}}),define("nireader/nireader-fe/2.0.0/template/common/notice",["nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/template"),e='<p class="word"><%==notice.word%></p><p class="op"><button id="confirm">嗯</button></p>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.0/template/template",["nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/kit/time").format;template.helper("formatTime",d),c.exports=template}),define("nireader/nireader-fe/2.0.0/kit/time",["nireader/nireader-fe/2.0.0/kit/num"],function(a,b){var c=a("nireader/nireader-fe/2.0.0/kit/num").toLength,d=function(){var a=new Date;return a.setMilliseconds(0),a.setSeconds(0),a.setMinutes(0),a.setHours(0),a},e=(new Date).getFullYear(),f=d();setInterval(function(){e=(new Date).getFullYear(),f=d()},6e4);var g=function(a,b){var c=new Date(a.valueOf());return c.setDate(c.getDate()-b),c},h=["今天","昨天","天前"],i=["零","一","两","三","四","五"],j=function(a){if(a>f)return h[0];if(a>g(f,1))return h[1];for(var b=2;5>=b;b++)if(a>g(f,b))return i[b]+h[2];var d="",j=a.getFullYear(),k=c(a.getMonth()+1,2),l=c(a.getDate(),2);return j!==e&&(d+=j+"年"),d+=k+"月"+l+"日"},k=function(a){return c(a.getHours(),2)+":"+c(a.getMinutes(),2)},l=function(a,b){if(null===a||void 0===a)return"某一天，嗯";var c=new Date(a);return b=void 0===b?"":b,j(c)+b+k(c)};b.formatDate=j,b.formatDay=k,b.format=l}),define("nireader/nireader-fe/2.0.0/kit/num",[],function(a,b){var c=function(a,b){var c=(a+"").slice(0,b);if(c.length<b)for(var d=c.length;b>d;d++)c="0"+c;return c},d=function(a,b){("number"!=typeof b||1>b)&&(b=1);var c=a.toFixed(b),d=/[0]+$/,e=/\.$/;return c.replace(d,"").replace(e,"")},e=function(a,b){a=a||0,b=b||100;var c=Math.random()*(b-a);return Math.floor(c+a)};b.toLength=c,b.format=d,b.random=e}),define("nireader/nireader-fe/2.0.0/kit/userinfo",["nireader/nireader-fe/2.0.0/kit/cookie"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/kit/cookie"),e="WhoAmI",f=function(a){a&&a(!!d.get(e))};c.exports={isLogin:f}}),define("nireader/nireader-fe/2.0.0/kit/cookie",[],function(a,b){var c=function(a){return new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+$').test(a)},d=function(a){if(c(a)){var b=new RegExp("(^| )"+a+"=([^;]*)(;|$)"),d=b.exec(document.cookie);if(d)return d[2]||null}return null},e=function(a){var b=d(a);return"string"==typeof b?b=decodeURIComponent(b):null};b.get=e}),define("nireader/nireader-fe/2.0.0/kit/eventList",[],function(a,b,c){var d={},e=function(a){a+=(Math.random()+"").slice(2);var b=d[a]=[];return LOG("create eventList: ",a),{name:a,list:b,add:function(a,c,d){LOG("add event: ",c," to ",this);for(var e=b.length-1;e>=0;e--)if(b[e].dom===a&&b[e].event===c&&b[e].handler===d)return;try{a.on(c,d),b.push({dom:a,event:c,handler:d})}catch(f){console.log(f.stack)}return b},remove:function(a,c,d){LOG("remove event: ",c," from ",this);for(var e=b.length-1;e>=0;e--)if(b[e].dom===a&&b[e].event===c&&b[e].handler===d){try{a.off(c,d),b.splice(e,1)}catch(f){console.log(f.stack)}break}},clean:function(){LOG("clean eventList: ",this);for(var c,e=b.length-1;e>=0;e--)try{c=b[e],c.dom.off(c.event,c.handler)}catch(f){console.log(f.stack)}b=d[a]=[],delete d[a]}}};c.exports={create:e}}),define("nireader/nireader-fe/2.0.0/template/home/title",["nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/template"),e="<%=user.name%>";c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.0/template/home/info",["nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/template"),e='<% if(user.description){ %><span class="mr20 ml150" title="<%=user.description%>"><%=user.description%></span><% } %><% if(user.homepage){ %><a class="mr20" href="<%=user.homepage%>" target="_blank" title="站点">站点</a><% } %>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.0/template/home/subscriptionList",["nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/template"),e='<ul id="subscription-list" class="item-list"><%if(subscriptions && subscriptions.length > 0){%><h6 class="sub-title">订阅：</h6><%for(i = 0; i < subscriptions.length; i ++) {%><li class="item" data-id="<%=subscriptions[i].id%>"><a data-link-async="true" href="<%=subscriptions[i].pageUrl%>"><%=subscriptions[i].title%></a><span class="pubdate"><%="更新于" + formatTime(subscriptions[i].pubDate, " ")%></span></li><%}%><%}else{%><h6 class="sub-title">没有订阅，</h6><%}%></ul>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.0/template/home/recommendList",["nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/template"),e='<h6 class="sub-title">推荐：</h6><ul id="recommend-list" class="item-list"><%for(i = 0; i < recommends.length; i ++) {%><li class="item" data-id="<%=recommends[i].id%>"><a data-link-async="true" href="<%=recommends[i].pageUrl%>"><%=recommends[i].title%></a><span class="pubdate"><%="更新于" + formatTime(recommends[i].pubDate, " ")%></span></li><%}%></ul>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.0/template/home/channelInfo",["nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/template"),e='<h3 class="channel-title"><%=channel.title%><i id="channel-subscribed" class="icon-eye-<%=channel.subscribed?"open":"close"%>" title="<%=channel.subscribed?"已订阅":"未订阅"%>"></i></h3><p class="channel-description"><%=channel.description%></p><p class="channel-generator"><%=channel.generator%></p>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.0/content/entrance",["nireader/nireader-fe/2.0.0/kit/request","nireader/nireader-fe/2.0.0/kit/customEvent","nireader/nireader-fe/2.0.0/kit/notice","nireader/nireader-fe/2.0.0/template/common/notice","nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num","nireader/nireader-fe/2.0.0/kit/userinfo","nireader/nireader-fe/2.0.0/kit/cookie","nireader/nireader-fe/2.0.0/kit/eventList","nireader/nireader-fe/2.0.0/interface/index"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/kit/request"),e=a("nireader/nireader-fe/2.0.0/kit/customEvent"),f=a("nireader/nireader-fe/2.0.0/kit/notice").notice,g=a("nireader/nireader-fe/2.0.0/kit/userinfo"),h=a("nireader/nireader-fe/2.0.0/kit/eventList"),i=a("nireader/nireader-fe/2.0.0/interface/index"),j=i.api,k=i.page,l=$("title"),m=function(){e.trigger("goto",k.home)},n=function(a){this.url=a.url,this.eventList=h.create("content/entrance"),this.type="entrance"};n.prototype.init=function(){g.isLogin(function(a){a&&m()}),this.prepareInfo(),l.text("Welcome"),this.dealLinks(),this.bindEvent()},n.prototype.dealLinks=function(){this.doms.topLink.hide(),this.doms.leftLink.hide(),this.doms.rightLink.hide()},n.prototype.bindEvent=function(){var a=this,b=this.doms;this.eventList.add(b.signin,"click",function(){return b.signinBlock.fadeIn(),!1}),this.eventList.add(b.submit,"click",function(){a.signIn()}),this.eventList.add(b.passwordIN,"keyup",function(b){13===b.which&&a.signIn()})},n.prototype.signIn=function(){var a=this.doms.nameIn.val(),b=this.doms.passwordIN.val();a&&b&&d.post({username:a,password:b},j.auth.in,function(a){return a?(f("错了。"),void 0):(m(),void 0)})},n.prototype.clean=function(){this.eventList.clean(),this.doms.wrapper.animate({marginTop:-this.doms.wrapper.height()+"px"},1e3,function(){$(this).hide()})},n.prototype.prepareInfo=function(){this.doms={wrapper:$("#header"),leftLink:$("#left-link"),rightLink:$("#right-link"),topLink:$("#top-link"),signin:$("#signin"),signinBlock:$("#signin-block"),nameIn:$("#name-in"),passwordIN:$("#password-in"),submit:$("#submit")}},c.exports=n}),define("nireader/nireader-fe/2.0.0/content/channel",["nireader/nireader-fe/2.0.0/kit/resource","nireader/nireader-fe/2.0.0/kit/request","nireader/nireader-fe/2.0.0/kit/cache","nireader/nireader-fe/2.0.0/kit/local","nireader/nireader-fe/2.0.0/config","nireader/nireader-fe/2.0.0/kit/url","nireader/nireader-fe/2.0.0/interface/index","nireader/nireader-fe/2.0.0/kit/eventList","nireader/nireader-fe/2.0.0/kit/notice","nireader/nireader-fe/2.0.0/template/common/notice","nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num","nireader/nireader-fe/2.0.0/kit/customEvent","nireader/nireader-fe/2.0.0/kit/userinfo","nireader/nireader-fe/2.0.0/kit/cookie","nireader/nireader-fe/2.0.0/template/channel/title","nireader/nireader-fe/2.0.0/template/channel/info","nireader/nireader-fe/2.0.0/template/channel/itemList"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/kit/resource"),e=a("nireader/nireader-fe/2.0.0/kit/request"),f=a("nireader/nireader-fe/2.0.0/interface/index"),g=f.page,h=f.api,i=a("nireader/nireader-fe/2.0.0/kit/url"),j=a("nireader/nireader-fe/2.0.0/kit/eventList"),k=a("nireader/nireader-fe/2.0.0/kit/notice").notice,l=a("nireader/nireader-fe/2.0.0/kit/customEvent"),m=a("nireader/nireader-fe/2.0.0/kit/userinfo"),n=a("nireader/nireader-fe/2.0.0/template/channel/title"),o=a("nireader/nireader-fe/2.0.0/template/channel/info"),p=a("nireader/nireader-fe/2.0.0/template/channel/itemList"),q=$("title"),r="/my/",s="/recommend/",t=function(a){this.url=a.url,this.wrapper=a.wrapper,this.eventList=j.create("content/channel"),this.type="channel"};t.prototype.init=function(){this.prepareInfo(),this.getItemListByPage(1),this.getChannelInfo();var a=this;m.isLogin(function(b){b?a.getNeighbourInfo():a.data.inSubscription?l.trigger("goto",a.url.slice(r.length-1)):a.dealNoUserinfo()}),this.bindEvent()},t.prototype.bindEvent=function(){},t.prototype.clean=function(){this.eventList.clean(),this.doms.sideContent.html(""),this.doms.sideBlock.clearQueue().stop().hide(),this.doms.leftLink.attr("href",""),this.doms.rightLink.attr("href",""),this.doms.topLink.attr("href","")},t.prototype.prepareInfo=function(){var a=this;a.data={id:parseInt(i.parse(a.url).id,10),inSubscription:0===a.url.indexOf(r),inRecommend:0===a.url.indexOf(s)},a.doms={wrapper:a.wrapper,middleBlock:a.wrapper.find("#middle-block"),title:a.wrapper.find("#title"),info:a.wrapper.find("#info"),content:a.wrapper.find("#content"),sideBlock:a.wrapper.find("#side-block"),sideContent:a.wrapper.find("#side-content"),leftLink:a.wrapper.find("#left-link"),rightLink:a.wrapper.find("#right-link"),topLink:a.wrapper.find("#top-link")},a.getItemListByPage=d.makeList("item",{source:a.data.id},function(b,c){return b?(console.error(b),void 0):(a.dealItemList(c),void 0)
})},t.prototype.getChannelInfo=function(){var a=this;d.get("channel",{id:a.data.id},function(b,c){return b?(404==b.status?k("走错地方了",function(){l.trigger("goto","/")}):LOG(b),void 0):(a.dealChannelInfo(c),void 0)})},t.prototype.dealChannelInfo=function(a){this.data.channel=a,this.renderChannelInfo({channel:a})},t.prototype.getNeighbourInfo=function(){var a=this,b="不知道这是哪",c=a.data.inSubscription?"subscription":"channel",e=a.data.inRecommend?{order:"score",descrease:!0}:null;d.list(c,null,null,function(c,d){if(c||d.length<1)return k(b),LOG(c||b),void 0;for(var e=-1,f=0,g=d.length;g>f;f++)if(parseInt(d[f].id,10)===a.data.id){e=f;break}return-1===e?(a.data.inSubscription?l.trigger("goto",a.url.slice(r.length-1)):k(b,function(){l.trigger("goto","/")}),void 0):(a.dealNeighbourInfo({prev:d[e-1],next:d[e+1]}),void 0)},e)},t.prototype.dealNeighbourInfo=function(a){this.doms.topLink.attr("href",g.home).attr("title","Home");var b=g.channel;b=this.data.inSubscription?g.myChannel:b,b=this.data.inRecommend?g.recommendChannel:b,a.prev?this.doms.leftLink.attr("href",b(a.prev.id)).attr("title",a.prev.title).show():this.doms.leftLink.hide(),a.next?this.doms.rightLink.attr("href",b(a.next.id)).attr("title",a.next.title).show():this.doms.rightLink.hide()},t.prototype.dealNoUserinfo=function(){this.doms.topLink.attr("href",g.home).attr("title","Home"),this.doms.leftLink.hide(),this.doms.rightLink.hide()},t.prototype.dealItemList=function(a){var b=this.data.inSubscription?g.myItem:g.recommendItem;a.map(function(a){return a.pageUrl=b(a.id),a}),this.data.items=a,this.renderItemList({items:a})},t.prototype.renderChannelInfo=function(a){var b=this;b.doms.title.html(n(a)),b.doms.info.html(o(a)),q.text(a.channel.title),b.doms.vote=b.doms.info.find("#vote"),b.doms.voteNum=b.doms.info.find("#vote-num"),b.doms.vote.on("click",function(a){a.preventDefault();var c=$(this).find("i");c.removeClass("icon-thumbs-up-alt").addClass("icon-spinner icon-spin"),e.post({cid:b.data.id},h.channel.vote,function(a){return c.removeClass("icon-spinner icon-spin"),a?(c.addClass("icon-frown"),setTimeout(function(){c.removeClass("icon-frown").addClass("icon-thumbs-up-alt")},1e3),void 0):(c.addClass("icon-ok"),b.doms.voteNum.text("["+ ++b.data.channel.score+"]"),d.refresh("channel",{id:b.data.id}),d.makeList("channel",null,null,{order:"score",descrease:!0},null,!0)(1),setTimeout(function(){c.removeClass("icon-ok").hide()},1e3),void 0)})})},t.prototype.sideBlockLoading=function(){this.doms.sideBlock.addClass("loading")},t.prototype.sideBlockLoad=function(a){this.doms.sideBlock.removeClass("loading"),this.doms.sideContent.html(a)},t.prototype.sideBlockGoto=function(a){var b=a.offset().top+this.doms.middleBlock.scrollTop(),c=parseInt(this.doms.sideBlock.css("top"),10);this.doms.sideBlock.stop().clearQueue().show().delay(200).animate({top:(6*b-c)/5},100).animate({top:b},50)},t.prototype.renderItemList=function(a){var b=this;b.doms.content.html(p(a));var c;this.eventList.add(b.doms.content.find(".item"),"mouseenter",function(){c&&(c=clearTimeout(c));var a=$(this),e=parseInt(a.attr("data-id"),10);b.doms.sideBlock.attr("data-iid",e),b.sideBlockGoto(a),b.sideBlockLoading(),d.get("item",{id:e},function(a,c){return b.doms.sideBlock.attr("data-iid")==e?a?(b.sideBlockLoad("Get item info failed."),void 0):(b.sideBlockLoad(c.content),void 0):void 0})}),this.eventList.add(b.doms.content,"mouseleave",function(){c=setTimeout(function(){b.doms.sideBlock.hide()},200)})},c.exports=t}),define("nireader/nireader-fe/2.0.0/template/channel/title",["nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/template"),e="<%=channel.title%>";c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.0/template/channel/info",["nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/template"),e='<% if(channel.description){ %><span class="mr20 ml150" title="<%=channel.description%>"><%=channel.description%></span><% } %><span class="mr20">更新于<%=formatTime(channel.pubDate)%></span><a class="mr20" href="<%=channel.link%>" target="_blank" title="站点">站点</a><span id="vote-num" class="mr10" title="被推荐<%=channel.score%>次">[<%=channel.score%>]</span><span id="vote" class="vote" title="推荐"><i class="icon-thumbs-up-alt"></i></span>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.0/template/channel/itemList",["nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/template"),e='<ul class="item-list"><%for(i = 0; i < items.length; i ++) {%><li class="item" data-id="<%=items[i].id%>"><a data-link-async="true" href="<%=items[i].pageUrl%>"><%=items[i].title%></a><span class="pubdate"><%=formatTime(items[i].pubDate, " ")%></span></li><%}%></ul>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.0/content/item",["nireader/nireader-fe/2.0.0/kit/resource","nireader/nireader-fe/2.0.0/kit/request","nireader/nireader-fe/2.0.0/kit/cache","nireader/nireader-fe/2.0.0/kit/local","nireader/nireader-fe/2.0.0/config","nireader/nireader-fe/2.0.0/kit/url","nireader/nireader-fe/2.0.0/interface/index","nireader/nireader-fe/2.0.0/kit/eventList","nireader/nireader-fe/2.0.0/kit/notice","nireader/nireader-fe/2.0.0/template/common/notice","nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num","nireader/nireader-fe/2.0.0/kit/customEvent","nireader/nireader-fe/2.0.0/template/item/title","nireader/nireader-fe/2.0.0/template/item/info","nireader/nireader-fe/2.0.0/template/item/content","nireader/nireader-fe/2.0.0/template/item/channelTitle","nireader/nireader-fe/2.0.0/kit/testScroll"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/kit/resource"),e=a("nireader/nireader-fe/2.0.0/interface/index").page,f=a("nireader/nireader-fe/2.0.0/kit/url"),g=a("nireader/nireader-fe/2.0.0/kit/eventList"),h=a("nireader/nireader-fe/2.0.0/kit/notice").notice,i=a("nireader/nireader-fe/2.0.0/kit/customEvent"),j=a("nireader/nireader-fe/2.0.0/template/item/title"),k=a("nireader/nireader-fe/2.0.0/template/item/info"),l=a("nireader/nireader-fe/2.0.0/template/item/content"),m=a("nireader/nireader-fe/2.0.0/template/item/channelTitle"),n=$("title"),o="/my/",p="/recommend/",q=a("nireader/nireader-fe/2.0.0/kit/testScroll"),r=q.bottom,s=q.top,t=function(a){this.url=a.url,this.wrapper=a.wrapper,this.eventList=g.create("content/item"),this.type="item"};t.prototype.init=function(){var a=this;a.prepareInfo(),a.getItemInfo(function(){a.getChannelInfo(),a.getNeighbourInfo(function(){a.preloadNeighbours()})}),a.bindEvent()},t.prototype.bindEvent=function(){var a=this.data,b=this.doms.middleBlock,c=this.doms.leftLink,d=this.doms.rightLink,e=this.doms.upButton,f=300,g=this.eventList.add,h=this.eventList.remove;this.doms.content.find("a").each(function(a,b){b=$(b),b.attr("data-link-async")||b.attr("target","_blank")}),g(e,"click",function(a){a.preventDefault(),e.animate({marginTop:"8px"},100,function(){b.animate({scrollTop:0},100,function(){e.css({marginTop:0})})})}),g(b,"scroll",function(){h(b,"mousewheel",i),h(b,"mousewheel",j);var a=b[0],c=40,d=60,f=a.scrollTop/(a.scrollHeight-a.clientHeight),g=f*(a.clientHeight-c-d-e.height())+c+"px",k=f;e.text(Math.floor(100*f)+"%").css({top:g,opacity:k})});var i=function(a,b,d,e){e>0&&"none"!==c.css("display")&&c.click()},j=function(a,b,c,e){0>e&&"none"!==d.css("display")&&d.click()},k=!0;setTimeout(function(){g(b,"mousewheel",function(c,d,e,h){return k?(k=!1,void 0):(h>0&&s(b)&&(a.timer1=a.timer1||setTimeout(function(){g(b,"mousewheel",i),a.timer1=null},f)),0>h&&r(b)&&(a.timer2=a.timer2||setTimeout(function(){g(b,"mousewheel",j),a.timer2=null},f)),void 0)})},200)},t.prototype.clean=function(){this.eventList.clean(),this.doms.upButton.remove(),clearTimeout(this.data.timer),clearTimeout(this.data.timer1),clearTimeout(this.data.timer2),this.doms.leftLink.attr("href",""),this.doms.rightLink.attr("href",""),this.doms.topLink.attr("href","")},t.prototype.prepareInfo=function(){var a=this;a.data={id:parseInt(f.parse(a.url).id,10),inSubscription:0===a.url.indexOf(o),inRecommend:0===a.url.indexOf(p)},a.doms={wrapper:a.wrapper,middleBlock:a.wrapper.find("#middle-block"),title:a.wrapper.find("#title"),info:a.wrapper.find("#info"),content:a.wrapper.find("#content"),leftLink:a.wrapper.find("#left-link"),rightLink:a.wrapper.find("#right-link"),topLink:a.wrapper.find("#top-link")};var b=document.createElement("div");b.className="up-button",a.doms.wrapper.append(b),a.doms.upButton=$(b)},t.prototype.getItemInfo=function(a){var b=this;d.get("item",{id:b.data.id},function(c,d){return c?(404==c.status?h("走错地方了。",function(){i.trigger("goto","/")}):LOG(c),void 0):(b.dealItemInfo(d),a&&a(),void 0)})},t.prototype.getChannelInfo=function(){var a=this;d.get("channel",{id:a.data.item.source},function(b,c){return b?(console.error(b||"Can not get channel"),void 0):(a.dealChannelInfo(c),void 0)})},t.prototype.preloadNeighbours=function(){var a;(a=this.data.neighbours.prev)&&d.get("item",{id:a.id}),(a=this.data.neighbours.next)&&d.get("item",{id:a.id})},t.prototype.dealItemInfo=function(a){this.data.item=a,this.renderItemInfo({item:a})},t.prototype.dealChannelInfo=function(a){var b=e.channel;b=this.data.inSubscription?e.myChannel:b,b=this.data.inRecommend?e.recommendChannel:b,a.pageUrl=b(a.id),this.data.channel=a,this.renderChannelInfo({channel:a})},t.prototype.getNeighbourInfo=function(a){var b=this;d.list("item",{source:b.data.item.source},null,function(c,d){if(c||d.length<1)return console.error(c||"Get aside item info fail."),void 0;for(var e=-1,f=0,g=d.length;g>f;f++)if(parseInt(d[f].id,10)===b.data.id){e=f;break}b.dealNeighbourInfo({prev:d[e-1],next:d[e+1]}),a&&a()})},t.prototype.dealNeighbourInfo=function(a){this.data.neighbours=a;var b=e.item;b=this.data.inSubscription?e.myItem:b,b=this.data.inRecommend?e.recommendItem:b,a.prev?this.doms.leftLink.attr("href",b(a.prev.id)).attr("title",a.prev.title).show():this.doms.leftLink.hide(),a.next?this.doms.rightLink.attr("href",b(a.next.id)).attr("title",a.next.title).show():this.doms.rightLink.hide()},t.prototype.renderItemInfo=function(a){n.text(a.item.title),this.doms.title.html(j(a)),this.doms.info.html(k(a)),this.doms.content.html(l(a))},t.prototype.renderChannelInfo=function(a){this.doms.topLink.attr("href",a.channel.pageUrl),this.doms.topLink.attr("title",a.channel.title),this.doms.info.prepend(m(a))},c.exports=t}),define("nireader/nireader-fe/2.0.0/template/item/title",["nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/template"),e="<%=item.title%>";c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.0/template/item/info",["nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/template"),e='<span class="mr40">于<%=formatTime(item.pubDate)%></span><a class="mr40" href="<%=item.link%>" target="_blank" title="原文">原文</a>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.0/template/item/content",["nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/template"),e="<%==item.content%>";c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.0/template/item/channelTitle",["nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/template"),e='<span class="">来自<a href="<%=channel.pageUrl%>" title="<%=channel.description%>" data-link-async=true ><%=channel.title%> </a></span>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.0/kit/testScroll",[],function(a,b){b.bottom=function(a){return a=a[0]||a,a&&a.scrollTop+a.clientHeight>=a.scrollHeight},b.top=function(a){return a=a[0]||a,a&&a.scrollTop<=0}}),define("nireader/nireader-fe/2.0.0/module/floater",["nireader/nireader-fe/2.0.0/kit/keypress","nireader/nireader-fe/2.0.0/kit/pattern","nireader/nireader-fe/2.0.0/kit/request","nireader/nireader-fe/2.0.0/kit/resource","nireader/nireader-fe/2.0.0/kit/cache","nireader/nireader-fe/2.0.0/kit/local","nireader/nireader-fe/2.0.0/config","nireader/nireader-fe/2.0.0/kit/url","nireader/nireader-fe/2.0.0/interface/index","nireader/nireader-fe/2.0.0/kit/notice","nireader/nireader-fe/2.0.0/template/common/notice","nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num","nireader/nireader-fe/2.0.0/kit/customEvent","nireader/nireader-fe/2.0.0/template/common/result","nireader/nireader-fe/2.0.0/template/common/tip","nireader/nireader-fe/2.0.0/template/common/loadingIcon"],function(a){var b,c,d,e=a("nireader/nireader-fe/2.0.0/kit/keypress"),f=a("nireader/nireader-fe/2.0.0/kit/pattern"),g=a("nireader/nireader-fe/2.0.0/kit/request"),h=a("nireader/nireader-fe/2.0.0/kit/resource"),i=a("nireader/nireader-fe/2.0.0/kit/notice").notice,j=a("nireader/nireader-fe/2.0.0/kit/url"),k=a("nireader/nireader-fe/2.0.0/kit/customEvent"),l=a("nireader/nireader-fe/2.0.0/interface/index"),m=l.api,n=l.page,o=a("nireader/nireader-fe/2.0.0/template/common/result"),p=a("nireader/nireader-fe/2.0.0/template/common/tip"),q=a("nireader/nireader-fe/2.0.0/template/common/loadingIcon")(),r=$("#body"),s=$("#floater"),t=$("#input"),u=$("#tips"),v=$("#results"),w=function(){b=t.val().trim()},x=function(){t.val("").focus(),Q(),u.hide(),v.hide()},y=function(){r.addClass("blur"),s.addClass("show"),x(),w()},z=function(){r.removeClass("blur"),s.removeClass("show")},A=function(){s.hasClass("show")?z():y()},B=function(){k.trigger("userInfoUpdate")},C=function(){v.html("").hide()},D=function(){u.html("").hide()},E=function(){D(),C()},F=function(a){u.show().prepend(p({tip:{word:a}}))},G=function(a){D(),F(a)},H=function(a,b,c){b=b||"javascript:;";var d=j.isSameDomain(b)?"":"_blank";v.show().append(o({result:{word:a,link:b,target:d,async:c}}))},I=function(a,b){g.post({url:a},m.channel.create,b)},J=function(a,b){g.post({channel:a},m.channel.save,b)},K=function(a,b){g.post({subscribee:a,description:""},m.subscription.add,b)},L=function(){var a=t.val();G("好像是个rss地址，等我解析下... "+q),I(a,function(d,e){if(a===b){if(E(),d)return G("没解析出来，地址不对。"),void 0;var f=!!e.id;G("用<b>Enter</b>"+(f?"":"添加并")+"订阅"),H(e.title,f?n.channel(e.id):e.link,f),c=function(){J(e,function(a,b){return a?(G("没添加成功。"),void 0):(G(b.title+"添加好了，正在订阅... "+q),K(b.id,function(a){return a?(G("订阅"+b.title+"没成功。"),void 0):(C(),G("订阅了"+b.title+"。"),B(),void 0)}),void 0)})}}})},M=function(){G("按<b>Enter</b>登出。"),c=function(){G("正在登出... "+q),g.get(m.auth.out,function(a){return a?(i("出错了。"),LOG(a),void 0):(location.href=n.home,void 0)})}},N=function(){G("按<b>Enter</b>去首页 ('/')。"),c=function(){G("正在去首页... "+q),k.trigger("goto","/"),D()}},O=function(a){if(a){for(var c=a.split(" "),d=[],e=0,f=c.length;f>e;e++)c[e]&&d.push(c[e]);if(!d.length)return;h.search("channel",d,1,function(c,d){if(a===b&&!c)for(var e=0,f=d.length;f>e;e++)H(d[e].title,n.channel(d[e].id),!0)})}},P={logout:M,home:N},Q=function(){var a=t.val().trim();if(a!=b){if(b=a,E(),a&&P[a])return P[a](),void 0;if(a&&f.url.test(a))return L(),void 0;var c,e,g;if(a)for(var h in P)P.hasOwnProperty(h)&&(c=h.indexOf(a))>=0&&(g=h,e=h.slice(0,c)+"<b>"+a+"</b>"+h.slice(c+a.length)+"	 ---- 用<b>Tab</b>补全",F(e));d=g&&function(){t.val(g)},O(a)}};t.on("keydown",function(a){9===a.which&&(a.preventDefault(),d&&!d(a))}),t.on("keyup",function(a){return 13===a.which&&c&&!c(a)?(t.val(""),void 0):(Q(),void 0)}),e.register(27,function(){A()})}),define("nireader/nireader-fe/2.0.0/kit/keypress",[],function(a,b,c){var d={},e=function(a,b,c){var d=a+"";return d+=b?"+ctrl":"",d+=c?"+alt":""},f=function(a,b,c,f){var g=e(a,c,f);d[g]=d[g]||[],d[g].push(b)},g=function(a,b,c,f){var g=e(a,b,c);if(d[g])for(var h=d[g],i=0,j=h.length;j>i;i++)try{h[i](f)}catch(f){}};$("body").on("keyup",function(a){return g(a.which,a.ctrlKey,a.altKey,a),a.preventDefault(),!1}),c.exports={register:f,trigger:g}}),define("nireader/nireader-fe/2.0.0/kit/pattern",[],function(a,b,c){var d=/[a-z]+\:\/\/[\w]+\.[\w]+/;c.exports={url:d}}),define("nireader/nireader-fe/2.0.0/template/common/result",["nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/template"),e='<li class="result"><a href="<%=result.link%>" target="<%=result.target%>" <%=result.async?"data-link-async=true":""%>><%==result.word%></a></li>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.0/template/common/tip",["nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/template"),e='<li class="tip"><%==tip.word%></li>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.0/template/common/loadingIcon",["nireader/nireader-fe/2.0.0/template/template","nireader/nireader-fe/2.0.0/kit/time","nireader/nireader-fe/2.0.0/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.0/template/template"),e='<i class="icon-spinner icon-spin" style="<% if(size){ %>font-size:<%=size*2%>px;<% } %>"></i>',f=d.compile(e);c.exports=function(a){return a=a||{},f(a)}});
