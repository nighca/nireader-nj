define("nireader/nireader-fe/2.0.1/page/reader",["../module/stateManager","../kit/url","../kit/customEvent","../module/page","../module/createContent","../content/home","../kit/resource","../kit/request","../kit/cache","../kit/local","../config","../interface/index","../kit/notice","../template/common/notice","../template/template","../kit/time","../kit/num","../kit/effect","../kit/userinfo","../kit/cookie","../kit/eventList","../template/home/title","../template/home/info","../template/home/subscriptionList","../template/home/recommendList","../template/home/channelInfo","../content/entrance","../template/common/loadingIcon","../content/channel","../kit/keypress","../template/channel/title","../template/channel/info","../template/channel/itemList","../content/item","../template/item/title","../template/item/info","../template/item/content","../template/item/channelTitle","../kit/testScroll","../module/floater","../kit/pattern","../template/common/result","../template/common/tip"],function(a,b,c){var d=a("../module/stateManager"),e=a("../module/page");a("../module/floater");var f=function(){d.on("checkout",function(a){e.checkout(a)})};c.exports={name:"reader",init:f}}),define("nireader/nireader-fe/2.0.1/module/stateManager",["nireader/nireader-fe/2.0.1/kit/url","nireader/nireader-fe/2.0.1/kit/customEvent"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/kit/url").format,e=a("nireader/nireader-fe/2.0.1/kit/customEvent"),f=function(){this.handlers={},this.init()};f.prototype.init=function(){this.bindEvent()},f.prototype.bindEvent=function(){var a=this,b=function(b){b=d(b),a.pushState({url:b,title:"Loading"}),a.checkout()};$("body").delegate("[data-link-async]","click",function(a){var c=$(this);return c.attr("disabled")||!c.attr("href")?!1:(a.ctrlKey||(a.preventDefault(),b(c.attr("href"))),void 0)}),e.on("goto",b),window.onpopstate=function(){a.checkout()}},f.prototype.pushState=function(a){history.pushState(a,a.title,a.url)},f.prototype.checkout=function(){this.trigger("checkout")},f.prototype.on=function(a,b){this.handlers[a]=this.handlers[a]||[],this.handlers[a].push(b)},f.prototype.trigger=function(a){var b=this.handlers[a],c=Array.prototype.slice.call(arguments,1);if(b)for(var d=0,e=b.length;e>d;d++)try{b[d].apply(this,c)}catch(f){console.warn(f),console.log(f.stack)}},c.exports=new f}),define("nireader/nireader-fe/2.0.1/kit/url",[],function(a,b){var c=function(a){return a.indexOf("://")>0},d=function(a){var b=a.indexOf("://");return 0>b?a:(a=a.slice(b+3),b=a.indexOf("/"),0>b?"/":a.slice(b))},e=function(a){return a.indexOf("/")?location.pathname.replace(/([\w\d\_]*)$/,a):a},f=function(a){return a?(a=d(a),a=e(a)):null},g=function(a){var b=/\/([\w]*)(\/([\w]+))?($|\?|\#)/,c={};if(b.test(a)){var d=b.exec(a);c.type=d[1],d[3]&&(c.id=parseInt(d[3],10))}return c},h=function(a){return a.indexOf("://")<0?!0:0===a.indexOf(location.origin)?!0:!1},i=function(a){return c(a)?a:location.origin+e(a)},j=function(a){for(var b,c={},d=/\+/g,e=/([^&;=]+)=?([^&;]*)/g,f=function(a){return decodeURIComponent(a.replace(d," "))},g=a.substring(1);b=e.exec(g);)c[f(b[1])]=f(b[2]);return c};b.format=f,b.parse=g,b.isSameDomain=h,b.complete=i,b.parseHash=j}),define("nireader/nireader-fe/2.0.1/kit/customEvent",[],function(a,b,c){var d={};c.exports={on:function(a,b){var c=d[a]=d[a]||[];c.indexOf(b)>=0||c.push(b)},off:function(a,b){var c,e;(c=d[a])&&(e=c.indexOf(b))>=0&&c.splice(e,1)},trigger:function(a){var b;if(b=d[a])for(var c=0,e=b.length;e>c;c++)try{b[c].apply(null,Array.prototype.slice.call(arguments,1))}catch(f){console.log(f.stack)}}}}),define("nireader/nireader-fe/2.0.1/module/page",["nireader/nireader-fe/2.0.1/module/createContent","nireader/nireader-fe/2.0.1/kit/url","nireader/nireader-fe/2.0.1/content/home","nireader/nireader-fe/2.0.1/kit/resource","nireader/nireader-fe/2.0.1/kit/request","nireader/nireader-fe/2.0.1/kit/cache","nireader/nireader-fe/2.0.1/kit/local","nireader/nireader-fe/2.0.1/config","nireader/nireader-fe/2.0.1/interface/index","nireader/nireader-fe/2.0.1/kit/notice","nireader/nireader-fe/2.0.1/template/common/notice","nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num","nireader/nireader-fe/2.0.1/kit/effect","nireader/nireader-fe/2.0.1/kit/userinfo","nireader/nireader-fe/2.0.1/kit/cookie","nireader/nireader-fe/2.0.1/kit/eventList","nireader/nireader-fe/2.0.1/kit/customEvent","nireader/nireader-fe/2.0.1/template/home/title","nireader/nireader-fe/2.0.1/template/home/info","nireader/nireader-fe/2.0.1/template/home/subscriptionList","nireader/nireader-fe/2.0.1/template/home/recommendList","nireader/nireader-fe/2.0.1/template/home/channelInfo","nireader/nireader-fe/2.0.1/content/entrance","nireader/nireader-fe/2.0.1/template/common/loadingIcon","nireader/nireader-fe/2.0.1/content/channel","nireader/nireader-fe/2.0.1/kit/keypress","nireader/nireader-fe/2.0.1/template/channel/title","nireader/nireader-fe/2.0.1/template/channel/info","nireader/nireader-fe/2.0.1/template/channel/itemList","nireader/nireader-fe/2.0.1/content/item","nireader/nireader-fe/2.0.1/template/item/title","nireader/nireader-fe/2.0.1/template/item/info","nireader/nireader-fe/2.0.1/template/item/content","nireader/nireader-fe/2.0.1/template/item/channelTitle","nireader/nireader-fe/2.0.1/kit/testScroll"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/module/createContent"),e=a("nireader/nireader-fe/2.0.1/kit/url"),f=a("nireader/nireader-fe/2.0.1/kit/notice"),g={wrapper:$("#body"),middleBlock:$("#middle-block")};g.getUrl=function(){this.url=e.format(location.href)},g.initContent=function(){this.content=d({url:this.url,wrapper:this.wrapper}),this.content.init()},g.init=function(){this.getUrl(),this.initContent(),this.middleBlock.animate({scrollTop:0},300)},g.clean=function(){f.clean(),this.content&&this.content.clean(),this.content=null},g.checkout=function(){var a=this;a.clean(),setTimeout(function(){a.init()},0)},c.exports=g}),define("nireader/nireader-fe/2.0.1/module/createContent",["nireader/nireader-fe/2.0.1/kit/url","nireader/nireader-fe/2.0.1/content/home","nireader/nireader-fe/2.0.1/kit/resource","nireader/nireader-fe/2.0.1/kit/request","nireader/nireader-fe/2.0.1/kit/cache","nireader/nireader-fe/2.0.1/kit/local","nireader/nireader-fe/2.0.1/config","nireader/nireader-fe/2.0.1/interface/index","nireader/nireader-fe/2.0.1/kit/notice","nireader/nireader-fe/2.0.1/template/common/notice","nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num","nireader/nireader-fe/2.0.1/kit/effect","nireader/nireader-fe/2.0.1/kit/userinfo","nireader/nireader-fe/2.0.1/kit/cookie","nireader/nireader-fe/2.0.1/kit/eventList","nireader/nireader-fe/2.0.1/kit/customEvent","nireader/nireader-fe/2.0.1/template/home/title","nireader/nireader-fe/2.0.1/template/home/info","nireader/nireader-fe/2.0.1/template/home/subscriptionList","nireader/nireader-fe/2.0.1/template/home/recommendList","nireader/nireader-fe/2.0.1/template/home/channelInfo","nireader/nireader-fe/2.0.1/content/entrance","nireader/nireader-fe/2.0.1/template/common/loadingIcon","nireader/nireader-fe/2.0.1/content/channel","nireader/nireader-fe/2.0.1/kit/keypress","nireader/nireader-fe/2.0.1/template/channel/title","nireader/nireader-fe/2.0.1/template/channel/info","nireader/nireader-fe/2.0.1/template/channel/itemList","nireader/nireader-fe/2.0.1/content/item","nireader/nireader-fe/2.0.1/template/item/title","nireader/nireader-fe/2.0.1/template/item/info","nireader/nireader-fe/2.0.1/template/item/content","nireader/nireader-fe/2.0.1/template/item/channelTitle","nireader/nireader-fe/2.0.1/kit/testScroll"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/kit/url"),e={home:a("nireader/nireader-fe/2.0.1/content/home"),welcome:a("nireader/nireader-fe/2.0.1/content/entrance"),channel:a("nireader/nireader-fe/2.0.1/content/channel"),item:a("nireader/nireader-fe/2.0.1/content/item")},f=function(a){var b=a.type||d.parse(a.url).type||"home",c=e[b];return c?new c(a):null};c.exports=f}),define("nireader/nireader-fe/2.0.1/content/home",["nireader/nireader-fe/2.0.1/kit/resource","nireader/nireader-fe/2.0.1/kit/request","nireader/nireader-fe/2.0.1/kit/cache","nireader/nireader-fe/2.0.1/kit/local","nireader/nireader-fe/2.0.1/config","nireader/nireader-fe/2.0.1/kit/url","nireader/nireader-fe/2.0.1/interface/index","nireader/nireader-fe/2.0.1/kit/notice","nireader/nireader-fe/2.0.1/template/common/notice","nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num","nireader/nireader-fe/2.0.1/kit/effect","nireader/nireader-fe/2.0.1/kit/userinfo","nireader/nireader-fe/2.0.1/kit/cookie","nireader/nireader-fe/2.0.1/kit/eventList","nireader/nireader-fe/2.0.1/kit/customEvent","nireader/nireader-fe/2.0.1/template/home/title","nireader/nireader-fe/2.0.1/template/home/info","nireader/nireader-fe/2.0.1/template/home/subscriptionList","nireader/nireader-fe/2.0.1/template/home/recommendList","nireader/nireader-fe/2.0.1/template/home/channelInfo"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/kit/resource"),e=a("nireader/nireader-fe/2.0.1/kit/request"),f=a("nireader/nireader-fe/2.0.1/kit/notice").notice,g=a("nireader/nireader-fe/2.0.1/kit/userinfo"),h=a("nireader/nireader-fe/2.0.1/kit/eventList"),i=a("nireader/nireader-fe/2.0.1/kit/customEvent"),j=a("nireader/nireader-fe/2.0.1/kit/effect"),k=a("nireader/nireader-fe/2.0.1/interface/index"),l=k.api,m=k.page,n=a("nireader/nireader-fe/2.0.1/template/home/title"),o=a("nireader/nireader-fe/2.0.1/template/home/info"),p=a("nireader/nireader-fe/2.0.1/template/home/subscriptionList"),q=a("nireader/nireader-fe/2.0.1/template/home/recommendList"),r=a("nireader/nireader-fe/2.0.1/template/home/channelInfo"),s=$("title"),t=function(a){this.url=a.url,this.wrapper=a.wrapper,this.eventList=h.create("content/home"),this.type="home"};t.prototype.init=function(){g.isLogin(function(a){a||(location.href=m.entrance)}),this.prepareInfo(),this.initDoms(),this.getAllSubscriptionList(),this.getRecommendList(),this.getUserInfo(),this.dealLinks(),this.bindEvent()},t.prototype.bindEvent=function(){var a=this;this.eventList.add(i,"userInfoUpdate",function(){a.refreshSubscriptionList()})},t.prototype.clean=function(){this.eventList.clean(),this.doms.sideContent.html(""),this.doms.sideBlock.clearQueue().stop().hide(),this.doms.leftLink.attr("href","").show(),this.doms.rightLink.attr("href","").show(),this.doms.topLink.attr("href","").show(),j.bodyBlur()},t.prototype.prepareInfo=function(){var a=this;a.data={},a.doms={wrapper:a.wrapper,middleBlock:a.wrapper.find("#middle-block"),title:a.wrapper.find("#title"),info:a.wrapper.find("#info"),content:a.wrapper.find("#content"),sideBlock:a.wrapper.find("#side-block"),sideContent:a.wrapper.find("#side-content"),leftLink:a.wrapper.find("#left-link"),rightLink:a.wrapper.find("#right-link"),topLink:a.wrapper.find("#top-link")},a.sideBlock=a.genSideBlock()},t.prototype.initDoms=function(){},t.prototype.genSideBlock=function(){var a,b=this,c=b.doms.middleBlock,g=b.doms.sideBlock,h=b.doms.sideContent,i=function(){g.addClass("loading")},j=function(a){g.removeClass("loading"),h.html(a)},k=function(a){var b=a.offset().top+c.scrollTop(),d=parseInt(g.css("top"),10);g.stop().clearQueue().show().delay(200).animate({top:(6*b-d)/5},100).animate({top:b},50)},m=function(){a=setTimeout(function(){g.hide()},200)},n=function(){a&&(a=clearTimeout(a))},o=function(a,c){c.addClass("icon-spinner icon-spin"),e.post({subscribee:a},l.subscription.add,function(a){c.removeClass("icon-spinner icon-spin"),a?(f("没订阅成"),LOG(a)):(c.addClass("icon-eye-open").removeClass("icon-eye-close"),b.refreshSubscriptionList())})},p=function(a,c){c.addClass("icon-spinner icon-spin"),e.post({subscribee:a},l.subscription.remove,function(a){c.removeClass("icon-spinner icon-spin"),a?(f("没能取消订阅"),LOG(a)):(c.addClass("icon-eye-close").removeClass("icon-eye-open"),b.refreshSubscriptionList(),m())})},q=function(a){var c=g.find("#channel-subscribed");b.eventList.add(c,"click",function(){(c.hasClass("icon-eye-open")?p:o)(a,c)})},s=function(){n();var a=$(this),c=a.attr("data-id");g.attr("data-cid",c),k(a),i(),d.get("channel",{id:c},function(a,d){if(g.attr("data-cid")==c){if(a)return j("Get channel info failed."),void 0;for(var e=b.data.subscriptions.length-1;e>=0;e--)if(b.data.subscriptions[e].id==d.id){d.subscribed=!0;break}j(r({channel:d})),q(c)}})},t=function(a){b.eventList.add(a.find(".item"),"mouseenter",s),b.eventList.add(a,"mouseleave",m)};return b.eventList.add(g,"mouseenter",n),b.eventList.add(g,"mouseleave",m),{bind:t}},t.prototype.getUserInfo=function(){var a=this;d.get("user",{},function(b,c){return b?(console.error(b||"Can not get user info."),void 0):(a.dealUserInfo(c),void 0)})},t.prototype.dealUserInfo=function(a){this.data.user=a,this.renderHomeInfo({user:a})},t.prototype.dealLinks=function(){this.doms.topLink.hide(),this.doms.leftLink.hide(),this.doms.rightLink.hide()},t.prototype.getSubscriptionListByPage=function(a){var b=this;d.makeList("subscription",null,function(c,d){return c?(console.error(c),void 0):(b.data.subscriptionListPage=a,b.dealSubscriptionList(d),void 0)})(a)},t.prototype.getAllSubscriptionList=function(a){var b=this;d.makeList("subscription",null,function(a,c){return a?(console.error(a),void 0):(b.dealSubscriptionList(c),void 0)},null,null,a)()},t.prototype.refreshSubscriptionList=function(){this.doms.subscriptionList&&this.doms.subscriptionList.remove(),this.getAllSubscriptionList(!0)},t.prototype.dealSubscriptionList=function(a){a.map(function(a){return a.pageUrl=m.myChannel(a.id),a}),this.data.subscriptions=a,this.renderSubscriptionList({subscriptions:a})},t.prototype.getRecommendList=function(){var a=this;d.makeList("channel",null,function(b,c){return b?(console.error(b),void 0):(a.dealRecommendList(c),void 0)},{order:"score",descrease:!0})(1)},t.prototype.dealRecommendList=function(a){a.map(function(a){return a.pageUrl=m.recommendChannel(a.id),a}),this.data.recommends=a,this.renderRecommendList({recommends:a})},t.prototype.renderHomeInfo=function(a){s.text(a.user.name+"'s reader"),this.doms.title.html(n(a)),this.doms.info.html(o(a))},t.prototype.renderSubscriptionList=function(a){this.recommendListReady?this.doms.content.prepend(p(a)):this.doms.content.html(p(a)),this.subscriptionListReady=!0,j.bodyUnblur(),this.doms.subscriptionList=this.doms.content.find("#subscription-list"),this.sideBlock.bind(this.doms.subscriptionList)},t.prototype.renderRecommendList=function(a){this.subscriptionListReady?this.doms.content.append(q(a)):this.doms.content.html(q(a)),this.recommendListReady=!0,this.doms.recommendList=this.doms.content.find("#recommend-list");var b=20;this.doms.recommendList.children().each(function(a,c){$(c).css("opacity",(b-a)/b)}),this.sideBlock.bind(this.doms.recommendList)},c.exports=t}),define("nireader/nireader-fe/2.0.1/kit/resource",["nireader/nireader-fe/2.0.1/kit/request","nireader/nireader-fe/2.0.1/kit/cache","nireader/nireader-fe/2.0.1/kit/local","nireader/nireader-fe/2.0.1/config","nireader/nireader-fe/2.0.1/kit/url","nireader/nireader-fe/2.0.1/interface/index"],function(a,b){var c=a("nireader/nireader-fe/2.0.1/kit/request"),d=a("nireader/nireader-fe/2.0.1/kit/cache");a("nireader/nireader-fe/2.0.1/kit/url").format;var e=a("nireader/nireader-fe/2.0.1/interface/index").api,f=a("nireader/nireader-fe/2.0.1/config").resource,g=f.lifetime,h={item:e.item.get,channel:e.channel.get,user:e.user.get},i={item:{order:"pubDate",descrease:!0},channel:{order:"id",descrease:!1},user:{order:"name",descrease:!1}},j=function(a,b,e,f){if(a&&"string"==typeof a){var j={cache:"resource",type:a,opt:b,sort:f},k={opt:b,sort:f||i[a]},l=h[a];c.get(k,l,function(a,b){a||d.set(j,b,g.resource),e&&e(a,b)})}},k=function(a,b,e,f,j){if(a&&"string"==typeof a){var k,l={cache:"resource",type:a,opt:b,sort:f};if(!j&&(k=d.get(l)))return e&&e(null,k),void 0;var m={opt:b,sort:f||i[a]},n=h[a];c.get(m,n,function(a,b){a||d.set(l,b,g.resource),e&&e(a,b)})}},l={item:e.item.list,channel:e.channel.list,subscription:e.subscription.list},m={item:["id","pubDate","title","source"],channel:["id","pubDate","title"],subscription:["channel.id","channel.pubDate","channel.title"]},n={item:{order:"pubDate",descrease:!0},channel:{order:"id",descrease:!1},subscription:{order:"channel.id",descrease:!1}},o={item:20,channel:20,subscription:20},p=function(a,b,e,f,h,i,j){if(a&&"string"==typeof a){var k,p={cache:"list",type:a,opt:b,sort:h};if(!j&&(k=d.get(p)))return f&&f(null,k),void 0;var q,r=o[a];q=e?"object"==typeof e?e:r?{from:r*(e-1),num:r}:null:null;var s={opt:b,fields:i||m[a],sort:h||n[a],limit:q},t=l[a];c.get(s,t,function(a,b){a||d.set(p,b,g.list),f&&f(a,b)})}},q=function(a,b,c,d,e,f){return function(g){return p(a,b,g,c,d,e,f)}},r={item:e.item.search,channel:e.channel.search,subscription:e.subscription.search},s=function(a,b,d,e,f,g){if(a&&"string"==typeof a){var h,i=o[a];"object"==typeof d&&(h=d);var j={keywords:b,fields:g||m[a],sort:f||n[a],limit:h||(i?{from:i*(d-1),num:i}:null)},k=r[a];c.get(j,k,e)}},t=function(a,b,c,d,e){return function(f){return s(a,b,f,c,d,e)}};b.refresh=j,b.get=k,b.list=p,b.search=s,b.makeList=q,b.makeSearch=t}),define("nireader/nireader-fe/2.0.1/kit/request",[],function(a,b){var c=3,d=function(a,b,e,f,g){"string"==typeof b&&(g=f,f=e,e=b,b=null),$.ajax(e,{data:b,type:a,dataType:"json",headers:{isAjax:!0},success:function(a){f&&f(a.err,a.data)},error:function(h){g===!0&&(g=c),"number"==typeof g&&g>0?d(a,b,e,f,--g):f&&f(h,null)}})};b.post=function(a,b,c,e){d("post",a,b,c,e)},b.get=function(a,b,c,e){d("get",a,b,c,e)}}),define("nireader/nireader-fe/2.0.1/kit/cache",["nireader/nireader-fe/2.0.1/kit/local","nireader/nireader-fe/2.0.1/config"],function(a,b,c){var d,e=a("nireader/nireader-fe/2.0.1/kit/local").create("cache"),f=a("nireader/nireader-fe/2.0.1/config").cache,g=f.manageInterval,h=f.lifetime,i=f.maxNum,j={},k=[],l=function(){window.LOG.apply(window,arguments),d&&clearTimeout(d),d=setTimeout(function(){window.LOG("storage: ",j,"hotList: ",k),d=null},10)},m=function(a,b){var c=k.indexOf(a);c>=0&&k.splice(c,1),b||k.push(a)},n=function(a,b,c){a=JSON.stringify(a),b=JSON.stringify(b),m(a),l("cache: ",a),j[a]={cnt:b,doom:Date.now()+(c||h)}},o=function(a){a=JSON.stringify(a);var b=j[a];return l((b?"catch":"miss")+" in cache: ",a),b?(m(a),JSON.parse(b.cnt)):void 0},p=function(){LOG("clear begin: ",j),j={},k=[],e.clear(),LOG("clear end: ",j)},q=function(){return e.getSize()},r=function(){LOG("save to local begin: ",j),e.clear();for(var a in j)j.hasOwnProperty(a)&&e.set(a,JSON.stringify(j[a]));LOG("save to local: ",j),setTimeout(function(){LOG("local size: ",e.getSize())},100)},s=function(){LOG("load from local begin: ",j);var a,b=e.getAll(),c=Date.now();for(var d in b)b.hasOwnProperty(d)&&(a=JSON.parse(b[d]),c<a.doom&&(j[d]=a));LOG("load from local: ",j)};window.storage=j,window.local=e;var t=function(){l("manage cache...");var a=Date.now();for(var b in j)j.hasOwnProperty(b)&&a>j[b].doom&&(m(b,!0),l("cache expired: ",b),delete j[b]);for(var b,c=k.length-i,d=0;c>d;d++)b=k[d],l("cache over num: ",b),delete j[b];k=k.slice(c,k.length),l("manage cache end."),r()};window.onbeforeunload=function(){r()};var u=function(){setInterval(t,g)};s(),u(),c.exports={set:n,get:o,clear:p,getSize:q}}),define("nireader/nireader-fe/2.0.1/kit/local",[],function(a,b,c){var d=function(a,b){return b+"$"+a},e=function(a,b){return a.slice(b.length+1)},f=function(a,b){return!b||0===a.indexOf(b+"$")},g=function(a,b,c){b=d(b,a);try{return localStorage[b]=c}catch(e){return LOG("set localStorage error: ",e),null}},h=function(a,b){return b=d(b,a),localStorage[b]},i=function(a,b){b=d(b,a),localStorage.removeItem(b)},j=function(a){for(var b,c,d={},g=0,h=localStorage.length;h>g;g++)b=localStorage.key(g),b&&f(b,a)&&(c=localStorage[b],d[e(b,a)]=c);return d},k=function(a){for(var b,c=localStorage.length-1;c>=0;c--)b=localStorage.key(c),b&&f(b,a)&&localStorage.removeItem(b)},l=function(a){for(var b,c,d=0,e=0,g=localStorage.length;g>e;e++)b=localStorage.key(e),b&&f(b,a)&&(c=localStorage[b],d+=b.length+c.length);var h=2*d,i=h/1024,j=i/1024;return{length:d,B:h,KB:i.toFixed(2),MB:j.toFixed(2)}},m=function(a){return{get:function(b){return h(a,b)},remove:function(b){return i(a,b)},set:function(b,c){return g(a,b,c)},getAll:function(){return j(a)},clear:function(){return k(a)},getSize:function(){return l(a)}}};c.exports={create:m}}),define("nireader/nireader-fe/2.0.1/config",[],function(a,b,c){c.exports={cache:{manageInterval:6e4,lifetime:6e4,maxNum:100},resource:{lifetime:{resource:36e5,list:6e4}},auth:{qq:{clientId:"100544244",scope:"get_user_info"}}}}),define("nireader/nireader-fe/2.0.1/interface/index",[],function(a,b,c){var d={channel:{get:"/api/channel",list:"/api/list/channel",search:"/api/search/channel",create:"/api/channel/create",save:"/api/channel/save",vote:"/api/channel/vote"},item:{get:"/api/item",list:"/api/list/item",search:"/api/search/item"},subscription:{get:"/api/subscription",list:"/api/list/subscription",add:"/api/subscription/add",remove:"/api/subscription/remove"},user:{get:"/api/user"},auth:{"in":"/api/signin",out:"/api/signout"}},e={home:"/",entrance:"/welcome",channel:function(a){return"/channel/"+a},item:function(a){return"/item/"+a},myChannel:function(a){return"/my/channel/"+a},myItem:function(a){return"/my/item/"+a},recommendChannel:function(a){return"/recommend/channel/"+a},recommendItem:function(a){return"/recommend/item/"+a},auth:{qq:{auth:"https://graph.qq.com/oauth2.0/authorize",callback:"/auth/qq",getId:"https://graph.qq.com/oauth2.0/me"}}};c.exports={api:d,page:e}}),define("nireader/nireader-fe/2.0.1/kit/notice",["nireader/nireader-fe/2.0.1/template/common/notice","nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num","nireader/nireader-fe/2.0.1/kit/effect"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/common/notice"),e=a("nireader/nireader-fe/2.0.1/kit/effect"),f=$("#notice"),g=!1,h=function(){g||(e.bodyBlur(),e.headerBlur(),e.floaterBlur(),f.show(),g=!0)},i=function(){g&&(e.bodyUnblur(),e.headerUnblur(),e.floaterUnblur(),f.hide(),g=!1)},j=function(){f.html("")},k=function(a){"object"==typeof a&&(a=JSON.stringify(a));var b={word:a};f.html(d({notice:b})),h()},l=function(a){f.find("#confirm").on("click",function(){i(),a&&a()})},m=function(a,b){k(a),l(b)},n=function(){j(),i()};c.exports={clean:n,notice:m,visible:function(){return g}}}),define("nireader/nireader-fe/2.0.1/template/common/notice",["nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/template"),e='<p class="word"><%==notice.word%></p><p class="op"><button id="confirm">嗯</button></p>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.1/template/template",["nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/kit/time").format;template.helper("formatTime",d),c.exports=template}),define("nireader/nireader-fe/2.0.1/kit/time",["nireader/nireader-fe/2.0.1/kit/num"],function(a,b){var c=a("nireader/nireader-fe/2.0.1/kit/num").toLength,d=function(){var a=new Date;return a.setMilliseconds(0),a.setSeconds(0),a.setMinutes(0),a.setHours(0),a},e=(new Date).getFullYear(),f=d();setInterval(function(){e=(new Date).getFullYear(),f=d()},6e4);var g=function(a,b){var c=new Date(a.valueOf());return c.setDate(c.getDate()-b),c},h=["今天","昨天","天前"],i=["零","一","两","三","四","五"],j=function(a){if(a>f)return h[0];if(a>g(f,1))return h[1];for(var b=2;5>=b;b++)if(a>g(f,b))return i[b]+h[2];var d="",j=a.getFullYear(),k=c(a.getMonth()+1,2),l=c(a.getDate(),2);return j!==e&&(d+=j+"年"),d+=k+"月"+l+"日"},k=function(a){return c(a.getHours(),2)+":"+c(a.getMinutes(),2)},l=function(a,b){if(null===a||void 0===a)return"我所不知道的某一天";var c=new Date(a);return b=void 0===b?"":b,j(c)+b+k(c)};b.formatDate=j,b.formatDay=k,b.format=l}),define("nireader/nireader-fe/2.0.1/kit/num",[],function(a,b){var c=function(a,b){var c=(a+"").slice(0,b);if(c.length<b)for(var d=c.length;b>d;d++)c="0"+c;return c},d=function(a,b){("number"!=typeof b||1>b)&&(b=1);var c=a.toFixed(b),d=/[0]+$/,e=/\.$/;return c.replace(d,"").replace(e,"")},e=function(a,b){a=a||0,b=b||100;var c=Math.random()*(b-a);return Math.floor(c+a)};b.toLength=c,b.format=d,b.random=e}),define("nireader/nireader-fe/2.0.1/kit/effect",[],function(a,b,c){var d=$("#body"),e=$("#header"),f=$("#floater"),g={},h=function(a){return g[a]=g[a]||0,g[a]=g[a]>0?g[a]-1:0,g[a]},i=function(a){return g[a]=g[a]||0,g[a]++,g[a]},j=function(a){return g[a]=0,g[a]},k=function(){i("bodyBlur"),d.addClass("blur"),d.addClass("half-transparent")},l=function(a){(a?j:h)("bodyBlur")||(d.removeClass("blur"),d.removeClass("half-transparent"))},m=function(){i("headerBlur"),e.addClass("blur")},n=function(a){(a?j:h)("headerBlur")||e.removeClass("blur")},o=function(){i("floaterBlur"),f.addClass("blur")},p=function(a){(a?j:h)("floaterBlur")||f.removeClass("blur")};c.exports={bodyBlur:k,bodyUnblur:l,headerBlur:m,headerUnblur:n,floaterBlur:o,floaterUnblur:p}}),define("nireader/nireader-fe/2.0.1/kit/userinfo",["nireader/nireader-fe/2.0.1/kit/cookie","nireader/nireader-fe/2.0.1/kit/request","nireader/nireader-fe/2.0.1/kit/cache","nireader/nireader-fe/2.0.1/kit/local","nireader/nireader-fe/2.0.1/config","nireader/nireader-fe/2.0.1/interface/index"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/kit/cookie"),e=a("nireader/nireader-fe/2.0.1/kit/request"),f=a("nireader/nireader-fe/2.0.1/kit/cache"),g=a("nireader/nireader-fe/2.0.1/interface/index"),h=g.api;g.page;var i="WhoAmI",j=function(a){a&&a(!!d.get(i))},k=function(a){e.get(h.auth.out,function(b){f.clear(),a&&a(b)})};c.exports={isLogin:j,logout:k}}),define("nireader/nireader-fe/2.0.1/kit/cookie",[],function(a,b){var c=function(a){return new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+$').test(a)},d=function(a){if(c(a)){var b=new RegExp("(^| )"+a+"=([^;]*)(;|$)"),d=b.exec(document.cookie);if(d)return d[2]||null}return null},e=function(a){var b=d(a);return"string"==typeof b?b=decodeURIComponent(b):null};b.get=e}),define("nireader/nireader-fe/2.0.1/kit/eventList",[],function(a,b,c){var d={},e=function(a){a+=(Math.random()+"").slice(2);var b=d[a]=[];return LOG("create eventList: ",a),{name:a,list:b,add:function(a,c,d){for(var e=b.length-1;e>=0;e--)if(b[e].dom===a&&b[e].event===c&&b[e].handler===d)return;try{a.on(c,d),b.push({dom:a,event:c,handler:d}),LOG("add event: ",c," to ",this)}catch(f){console.log(f.stack)}return b},remove:function(a,c,d){for(var e=b.length-1;e>=0;e--)if(b[e].dom===a&&b[e].event===c&&b[e].handler===d){try{a.off(c,d),b.splice(e,1),LOG("remove event: ",c," from ",this)}catch(f){console.log(f.stack)}break}},clean:function(){LOG("clean eventList: ",this);for(var c,e=b.length-1;e>=0;e--)try{c=b[e],c.dom.off(c.event,c.handler)}catch(f){console.log(f.stack)}b=d[a]=[],delete d[a]}}};c.exports={create:e}}),define("nireader/nireader-fe/2.0.1/template/home/title",["nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/template"),e="<%=user.name%>";c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.1/template/home/info",["nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/template"),e='<% if(user.description){ %><span class="mr20 ml150" title="<%=user.description%>"><%=user.description%></span><% } %><% if(user.homepage){ %><a class="mr20" href="<%=user.homepage%>" target="_blank" title="站点">站点</a><% } %>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.1/template/home/subscriptionList",["nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/template"),e='<ul id="subscription-list" class="item-list"><%if(subscriptions && subscriptions.length > 0){%><h6 class="sub-title">订阅：</h6><%for(i = 0; i < subscriptions.length; i ++) {%><li class="item" data-id="<%=subscriptions[i].id%>"><a data-link-async="true" href="<%=subscriptions[i].pageUrl%>"><%=subscriptions[i].title%></a><span class="pubdate"><%="更新于" + formatTime(subscriptions[i].pubDate, " ")%></span></li><%}%><%}else{%><h6 class="sub-title">没有订阅，</h6><%}%></ul>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.1/template/home/recommendList",["nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/template"),e='<h6 class="sub-title">推荐：</h6><ul id="recommend-list" class="item-list"><%for(i = 0; i < recommends.length; i ++) {%><li class="item" data-id="<%=recommends[i].id%>"><a data-link-async="true" href="<%=recommends[i].pageUrl%>"><%=recommends[i].title%></a><span class="pubdate"><%="更新于" + formatTime(recommends[i].pubDate, " ")%></span></li><%}%></ul>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.1/template/home/channelInfo",["nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/template"),e='<h3 class="channel-title"><%=channel.title%><i id="channel-subscribed" class="icon-eye-<%=channel.subscribed?"open":"close"%>" title="<%=channel.subscribed?"已订阅":"未订阅"%>"></i></h3><p class="channel-description"><%=channel.description%></p><p class="channel-generator"><%=channel.generator%></p>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.1/content/entrance",["nireader/nireader-fe/2.0.1/kit/request","nireader/nireader-fe/2.0.1/kit/customEvent","nireader/nireader-fe/2.0.1/kit/notice","nireader/nireader-fe/2.0.1/template/common/notice","nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num","nireader/nireader-fe/2.0.1/kit/effect","nireader/nireader-fe/2.0.1/kit/userinfo","nireader/nireader-fe/2.0.1/kit/cookie","nireader/nireader-fe/2.0.1/kit/cache","nireader/nireader-fe/2.0.1/kit/local","nireader/nireader-fe/2.0.1/config","nireader/nireader-fe/2.0.1/interface/index","nireader/nireader-fe/2.0.1/kit/eventList","nireader/nireader-fe/2.0.1/kit/url","nireader/nireader-fe/2.0.1/template/common/loadingIcon"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/kit/request"),e=a("nireader/nireader-fe/2.0.1/kit/customEvent"),f=a("nireader/nireader-fe/2.0.1/kit/notice").notice,g=a("nireader/nireader-fe/2.0.1/kit/userinfo"),h=a("nireader/nireader-fe/2.0.1/kit/eventList"),i=a("nireader/nireader-fe/2.0.1/kit/url"),j=a("nireader/nireader-fe/2.0.1/interface/index"),k=a("nireader/nireader-fe/2.0.1/config").auth,l=j.api,m=j.page,n=a("nireader/nireader-fe/2.0.1/template/common/loadingIcon")(),o=$("title"),p=function(){e.trigger("goto",m.home)},q=function(a){this.url=a.url,this.eventList=h.create("content/entrance"),this.type="entrance"};q.prototype.init=function(){g.isLogin(function(a){a&&p()}),this.prepareInfo(),o.text("Welcome"),this.dealLinks(),this.bindEvent()},q.prototype.dealLinks=function(){this.doms.topLink.hide(),this.doms.leftLink.hide(),this.doms.rightLink.hide()},q.prototype.bindEvent=function(){var a=this,b=this.doms,c=function(a,c){b.status.html(a+(c?" "+n:""))};this.eventList.add(b.qq,"click",function(){var a=k.qq,b=m.auth.qq.auth,e=encodeURIComponent(i.complete(m.auth.qq.callback));b+="?response_type=token",b+="&client_id="+a.clientId,b+="&redirect_uri="+e,b+="&scope="+a.scope,c("在新页面中授权"),window.finishAuth=function(a){var b=m.auth.qq.getId;b+="?access_token="+a.access_token,window.callback=function(b){c("登录",!0),d.post({username:b.openid,password:a.access_token,thirdParty:"qq"},l.auth.in,function(a,b){return a?(f(b),void 0):(c("登录成功",!0),p(),void 0)
}),delete window.callback};var e=document.createElement("script");e.src=b,document.body.appendChild(e),c("获取基本信息",!0),delete window.finishAuth},window.open(b)}),this.eventList.add(b.submit,"click",function(){a.signIn()}),this.eventList.add(b.passwordIN,"keyup",function(b){13===b.which&&a.signIn()})},q.prototype.signIn=function(){var a=this.doms.nameIn.val(),b=this.doms.passwordIN.val();if(a&&b){var c=this.doms.status,e=function(a,b){c.html(a+(b?" "+n:""))};e("登录",!0),d.post({username:a,password:b},l.auth.in,function(a){return a?(f("错了。"),void 0):(e("登录成功",!0),p(),void 0)})}},q.prototype.clean=function(){this.eventList.clean(),this.doms.wrapper.animate({marginTop:-this.doms.wrapper.height()+"px"},1e3,function(){$(this).hide()})},q.prototype.prepareInfo=function(){this.doms={wrapper:$("#header"),leftLink:$("#left-link"),rightLink:$("#right-link"),topLink:$("#top-link"),signin:$("#signin"),signinBlock:$("#signin-block"),nameIn:$("#name-in"),passwordIN:$("#password-in"),submit:$("#submit"),qq:$("#qq"),status:$("#status")}},c.exports=q}),define("nireader/nireader-fe/2.0.1/template/common/loadingIcon",["nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/template"),e='<i class="icon-spinner icon-spin" style="<% if(size){ %>font-size:<%=size*2%>px;<% } %>"></i>',f=d.compile(e);c.exports=function(a){return a=a||{},f(a)}}),define("nireader/nireader-fe/2.0.1/content/channel",["nireader/nireader-fe/2.0.1/kit/resource","nireader/nireader-fe/2.0.1/kit/request","nireader/nireader-fe/2.0.1/kit/cache","nireader/nireader-fe/2.0.1/kit/local","nireader/nireader-fe/2.0.1/config","nireader/nireader-fe/2.0.1/kit/url","nireader/nireader-fe/2.0.1/interface/index","nireader/nireader-fe/2.0.1/kit/eventList","nireader/nireader-fe/2.0.1/kit/notice","nireader/nireader-fe/2.0.1/template/common/notice","nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num","nireader/nireader-fe/2.0.1/kit/effect","nireader/nireader-fe/2.0.1/kit/customEvent","nireader/nireader-fe/2.0.1/kit/keypress","nireader/nireader-fe/2.0.1/kit/userinfo","nireader/nireader-fe/2.0.1/kit/cookie","nireader/nireader-fe/2.0.1/template/channel/title","nireader/nireader-fe/2.0.1/template/channel/info","nireader/nireader-fe/2.0.1/template/channel/itemList"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/kit/resource"),e=a("nireader/nireader-fe/2.0.1/kit/request"),f=a("nireader/nireader-fe/2.0.1/interface/index"),g=f.page,h=f.api,i=a("nireader/nireader-fe/2.0.1/kit/url"),j=a("nireader/nireader-fe/2.0.1/kit/eventList"),k=a("nireader/nireader-fe/2.0.1/kit/notice").notice,l=a("nireader/nireader-fe/2.0.1/kit/customEvent"),m=a("nireader/nireader-fe/2.0.1/kit/effect"),n=a("nireader/nireader-fe/2.0.1/kit/keypress"),o=a("nireader/nireader-fe/2.0.1/kit/userinfo"),p=a("nireader/nireader-fe/2.0.1/template/channel/title"),q=a("nireader/nireader-fe/2.0.1/template/channel/info"),r=a("nireader/nireader-fe/2.0.1/template/channel/itemList"),s=$("title"),t="/my/",u="/recommend/",v=function(a){this.url=a.url,this.wrapper=a.wrapper,this.eventList=j.create("content/channel"),this.type="channel"};v.prototype.init=function(){this.prepareInfo(),this.getItemListByPage(1),this.getChannelInfo();var a=this;o.isLogin(function(b){b?a.getNeighbourInfo():a.data.inSubscription?l.trigger("goto",a.url.slice(t.length-1)):a.dealNoUserinfo()}),this.bindEvent()},v.prototype.bindEvent=function(){var a=this.doms.leftLink,b=this.doms.rightLink;this.eventList.add(n,n.code.left,function(){a.click()}),this.eventList.add(n,n.code.right,function(){b.click()})},v.prototype.clean=function(){this.eventList.clean(),this.doms.sideContent.html(""),this.doms.sideBlock.clearQueue().stop().hide(),this.doms.leftLink.attr("href",""),this.doms.rightLink.attr("href",""),this.doms.topLink.attr("href",""),m.bodyBlur()},v.prototype.prepareInfo=function(){var a=this;a.data={id:parseInt(i.parse(a.url).id,10),inSubscription:0===a.url.indexOf(t),inRecommend:0===a.url.indexOf(u)},a.doms={wrapper:a.wrapper,middleBlock:a.wrapper.find("#middle-block"),title:a.wrapper.find("#title"),info:a.wrapper.find("#info"),content:a.wrapper.find("#content"),sideBlock:a.wrapper.find("#side-block"),sideContent:a.wrapper.find("#side-content"),leftLink:a.wrapper.find("#left-link"),rightLink:a.wrapper.find("#right-link"),topLink:a.wrapper.find("#top-link")},a.getItemListByPage=d.makeList("item",{source:a.data.id},function(b,c){return b?(console.error(b),void 0):(a.dealItemList(c),void 0)})},v.prototype.getChannelInfo=function(){var a=this;d.get("channel",{id:a.data.id},function(b,c){return b?(404==b.status?k("走错地方了",function(){l.trigger("goto","/")}):LOG(b),void 0):(a.dealChannelInfo(c),void 0)})},v.prototype.dealChannelInfo=function(a){this.data.channel=a,this.renderChannelInfo({channel:a})},v.prototype.getNeighbourInfo=function(){var a=this,b="不知道这是哪",c=a.data.inSubscription?"subscription":"channel",e=a.data.inRecommend?{order:"score",descrease:!0}:null;d.list(c,null,null,function(c,d){if(c||d.length<1)return k(b),LOG(c||b),void 0;for(var e=-1,f=0,g=d.length;g>f;f++)if(parseInt(d[f].id,10)===a.data.id){e=f;break}return-1===e?(a.data.inSubscription?l.trigger("goto",a.url.slice(t.length-1)):k(b,function(){l.trigger("goto","/")}),void 0):(a.dealNeighbourInfo({prev:d[e-1],next:d[e+1]}),void 0)},e)},v.prototype.dealNeighbourInfo=function(a){this.doms.topLink.attr("href",g.home).attr("title","Home");var b=g.channel;b=this.data.inSubscription?g.myChannel:b,b=this.data.inRecommend?g.recommendChannel:b,a.prev?this.doms.leftLink.attr("href",b(a.prev.id)).attr("title",a.prev.title).show():this.doms.leftLink.hide(),a.next?this.doms.rightLink.attr("href",b(a.next.id)).attr("title",a.next.title).show():this.doms.rightLink.hide()},v.prototype.dealNoUserinfo=function(){this.doms.topLink.attr("href",g.home).attr("title","Home"),this.doms.leftLink.hide(),this.doms.rightLink.hide()},v.prototype.dealItemList=function(a){var b=this.data.inSubscription?g.myItem:g.recommendItem;a.map(function(a){return a.pageUrl=b(a.id),a}),this.data.items=a,this.renderItemList({items:a})},v.prototype.renderChannelInfo=function(a){var b=this;b.doms.title.html(p(a)),b.doms.info.html(q(a)),s.text(a.channel.title),b.doms.vote=b.doms.info.find("#vote"),b.doms.voteNum=b.doms.info.find("#vote-num"),b.doms.vote.on("click",function(a){a.preventDefault();var c=$(this).find("i");c.removeClass("icon-thumbs-up-alt").addClass("icon-spinner icon-spin"),e.post({cid:b.data.id},h.channel.vote,function(a){return c.removeClass("icon-spinner icon-spin"),a?(c.addClass("icon-frown"),setTimeout(function(){c.removeClass("icon-frown").addClass("icon-thumbs-up-alt")},1e3),void 0):(c.addClass("icon-ok"),b.doms.voteNum.text("["+ ++b.data.channel.score+"]"),d.refresh("channel",{id:b.data.id}),d.makeList("channel",null,null,{order:"score",descrease:!0},null,!0)(1),setTimeout(function(){c.removeClass("icon-ok").hide()},1e3),void 0)})})},v.prototype.sideBlockLoading=function(){this.doms.sideBlock.addClass("loading")},v.prototype.sideBlockLoad=function(a){this.doms.sideBlock.removeClass("loading"),this.doms.sideContent.html(a)},v.prototype.sideBlockGoto=function(a){var b=a.offset().top+this.doms.middleBlock.scrollTop(),c=parseInt(this.doms.sideBlock.css("top"),10);this.doms.sideBlock.stop().clearQueue().show().delay(200).animate({top:(6*b-c)/5},100).animate({top:b},50)},v.prototype.renderItemList=function(a){var b=this;b.doms.content.html(r(a)),m.bodyUnblur();var c;this.eventList.add(b.doms.content.find(".item"),"mouseenter",function(){c&&(c=clearTimeout(c));var a=$(this),e=parseInt(a.attr("data-id"),10);b.doms.sideBlock.attr("data-iid",e),b.sideBlockGoto(a),b.sideBlockLoading(),d.get("item",{id:e},function(a,c){return b.doms.sideBlock.attr("data-iid")==e?a?(b.sideBlockLoad("Get item info failed."),void 0):(b.sideBlockLoad(c.content),void 0):void 0})}),this.eventList.add(b.doms.content,"mouseleave",function(){c=setTimeout(function(){b.doms.sideBlock.hide()},200)})},c.exports=v}),define("nireader/nireader-fe/2.0.1/kit/keypress",[],function(a,b,c){var d={},e={left:37,up:38,right:39,down:40,enter:13,backspace:8},f=function(a,b,c){var d=a+"";return d+=b?"+ctrl":"",d+=c?"+alt":""},g=function(a,b,c,e){var g=f(a,c,e);d[g]=d[g]||[],d[g].push(b)},h=function(a,b,c,e){var g,h,i=f(a,c,e);(g=d[i])&&(h=g.indexOf(b))>=0&&g.splice(h,1)},i=function(a,b,c,e){var g=f(a,b,c);if(d[g])for(var h=d[g],i=0,j=h.length;j>i;i++)try{h[i](e)}catch(e){}};$("body").on("keyup",function(a){return LOG("keypress",a.which,a.ctrlKey,a.altKey,a),i(a.which,a.ctrlKey,a.altKey,a),!1});var j=function(a,b){return(a="number"==typeof a?{which:a}:a)?g(a.which,b,a.ctrl,a.alt):void 0},k=function(a,b){return(a="number"==typeof a?{which:a}:a)?h(a.which,b,a.ctrl,a.alt):void 0};c.exports={register:g,unregister:h,on:j,off:k,trigger:i,code:e}}),define("nireader/nireader-fe/2.0.1/template/channel/title",["nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/template"),e="<%=channel.title%>";c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.1/template/channel/info",["nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/template"),e='<% if(channel.description){ %><span class="mr20 ml150" title="<%=channel.description%>"><%=channel.description%></span><% } %><span class="mr20">更新于<%=formatTime(channel.pubDate)%></span><a class="mr20" href="<%=channel.link%>" target="_blank" title="站点">站点</a><span id="vote-num" class="mr10" title="被推荐<%=channel.score%>次">[<%=channel.score%>]</span><span id="vote" class="vote" title="推荐"><i class="icon-thumbs-up-alt"></i></span>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.1/template/channel/itemList",["nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/template"),e='<ul class="item-list"><%for(i = 0; i < items.length; i ++) {%><li class="item" data-id="<%=items[i].id%>"><a data-link-async="true" href="<%=items[i].pageUrl%>"><%=items[i].title%></a><span class="pubdate"><%=formatTime(items[i].pubDate, " ")%></span></li><%}%></ul>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.1/content/item",["nireader/nireader-fe/2.0.1/kit/resource","nireader/nireader-fe/2.0.1/kit/request","nireader/nireader-fe/2.0.1/kit/cache","nireader/nireader-fe/2.0.1/kit/local","nireader/nireader-fe/2.0.1/config","nireader/nireader-fe/2.0.1/kit/url","nireader/nireader-fe/2.0.1/interface/index","nireader/nireader-fe/2.0.1/kit/eventList","nireader/nireader-fe/2.0.1/kit/notice","nireader/nireader-fe/2.0.1/template/common/notice","nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num","nireader/nireader-fe/2.0.1/kit/effect","nireader/nireader-fe/2.0.1/kit/customEvent","nireader/nireader-fe/2.0.1/kit/keypress","nireader/nireader-fe/2.0.1/template/item/title","nireader/nireader-fe/2.0.1/template/item/info","nireader/nireader-fe/2.0.1/template/item/content","nireader/nireader-fe/2.0.1/template/item/channelTitle","nireader/nireader-fe/2.0.1/kit/testScroll"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/kit/resource"),e=a("nireader/nireader-fe/2.0.1/interface/index").page,f=a("nireader/nireader-fe/2.0.1/kit/url"),g=a("nireader/nireader-fe/2.0.1/kit/eventList"),h=a("nireader/nireader-fe/2.0.1/kit/notice").notice,i=a("nireader/nireader-fe/2.0.1/kit/customEvent"),j=a("nireader/nireader-fe/2.0.1/kit/effect"),k=a("nireader/nireader-fe/2.0.1/kit/keypress"),l=a("nireader/nireader-fe/2.0.1/template/item/title"),m=a("nireader/nireader-fe/2.0.1/template/item/info"),n=a("nireader/nireader-fe/2.0.1/template/item/content"),o=a("nireader/nireader-fe/2.0.1/template/item/channelTitle"),p=$("title"),q="/my/",r="/recommend/",s=a("nireader/nireader-fe/2.0.1/kit/testScroll"),t=s.bottom,u=s.top,v=function(a){this.url=a.url,this.wrapper=a.wrapper,this.eventList=g.create("content/item"),this.type="item"};v.prototype.init=function(){var a=this;a.prepareInfo(),a.getItemInfo(function(){a.getChannelInfo(),a.getNeighbourInfo(function(){a.preloadNeighbours()})}),a.bindEvent()},v.prototype.bindEvent=function(){var a=this.data,b=this.doms.middleBlock,c=this.doms.leftLink,d=this.doms.rightLink,e=this.doms.upButton,f=300,g=this.eventList.add.bind(this.eventList),h=this.eventList.remove.bind(this.eventList);this.doms.content.find("a").each(function(a,b){b=$(b),b.attr("data-link-async")||b.attr("target","_blank")}),g(e,"click",function(a){a.preventDefault(),e.animate({marginTop:"8px"},100,function(){b.animate({scrollTop:0},100,function(){e.css({marginTop:0})})})}),g(b,"scroll",function(){h(b,"mousewheel",i),h(b,"mousewheel",j);var a=b[0],c=40,d=60,f=a.scrollTop/(a.scrollHeight-a.clientHeight),g=f*(a.clientHeight-c-d-e.height())+c+"px",k=f;e.text(Math.floor(100*f)+"%").css({top:g,opacity:k})});var i=function(a,b,d,e){e>0&&"none"!==c.css("display")&&c.click()},j=function(a,b,c,e){0>e&&"none"!==d.css("display")&&d.click()},l=!0;setTimeout(function(){g(b,"mousewheel",function(c,d,e,h){return l?(l=!1,void 0):(h>0&&u(b)&&(a.timer1=a.timer1||setTimeout(function(){g(b,"mousewheel",i),a.timer1=null},f)),0>h&&t(b)&&(a.timer2=a.timer2||setTimeout(function(){g(b,"mousewheel",j),a.timer2=null},f)),void 0)})},200),g(k,k.code.left,function(){c.click()}),g(k,k.code.right,function(){d.click()})},v.prototype.clean=function(){this.eventList.clean(),this.doms.upButton.remove(),clearTimeout(this.data.timer),clearTimeout(this.data.timer1),clearTimeout(this.data.timer2),this.doms.leftLink.attr("href",""),this.doms.rightLink.attr("href",""),this.doms.topLink.attr("href",""),j.bodyBlur()},v.prototype.prepareInfo=function(){var a=this;a.data={id:parseInt(f.parse(a.url).id,10),inSubscription:0===a.url.indexOf(q),inRecommend:0===a.url.indexOf(r)},a.doms={wrapper:a.wrapper,middleBlock:a.wrapper.find("#middle-block"),title:a.wrapper.find("#title"),info:a.wrapper.find("#info"),content:a.wrapper.find("#content"),leftLink:a.wrapper.find("#left-link"),rightLink:a.wrapper.find("#right-link"),topLink:a.wrapper.find("#top-link")};var b=document.createElement("div");b.className="up-button",a.doms.wrapper.append(b),a.doms.upButton=$(b)},v.prototype.getItemInfo=function(a){var b=this;d.get("item",{id:b.data.id},function(c,d){return c?(404==c.status?h("走错地方了。",function(){i.trigger("goto","/")}):LOG(c),void 0):(b.dealItemInfo(d),a&&a(),void 0)})},v.prototype.getChannelInfo=function(){var a=this;d.get("channel",{id:a.data.item.source},function(b,c){return b?(console.error(b||"Can not get channel"),void 0):(a.dealChannelInfo(c),void 0)})},v.prototype.preloadNeighbours=function(){var a;(a=this.data.neighbours.prev)&&d.get("item",{id:a.id}),(a=this.data.neighbours.next)&&d.get("item",{id:a.id})},v.prototype.dealItemInfo=function(a){this.data.item=a,this.renderItemInfo({item:a})},v.prototype.dealChannelInfo=function(a){var b=e.channel;b=this.data.inSubscription?e.myChannel:b,b=this.data.inRecommend?e.recommendChannel:b,a.pageUrl=b(a.id),this.data.channel=a,this.renderChannelInfo({channel:a})},v.prototype.getNeighbourInfo=function(a){var b=this;d.list("item",{source:b.data.item.source},null,function(c,d){if(c||d.length<1)return console.error(c||"Get aside item info fail."),void 0;for(var e=-1,f=0,g=d.length;g>f;f++)if(parseInt(d[f].id,10)===b.data.id){e=f;break}b.dealNeighbourInfo({prev:d[e-1],next:d[e+1]}),a&&a()})},v.prototype.dealNeighbourInfo=function(a){this.data.neighbours=a;var b=e.item;b=this.data.inSubscription?e.myItem:b,b=this.data.inRecommend?e.recommendItem:b,a.prev?this.doms.leftLink.attr("href",b(a.prev.id)).attr("title",a.prev.title).show():this.doms.leftLink.hide(),a.next?this.doms.rightLink.attr("href",b(a.next.id)).attr("title",a.next.title).show():this.doms.rightLink.hide()},v.prototype.renderItemInfo=function(a){p.text(a.item.title),this.doms.title.html(l(a)),this.doms.info.html(m(a)),this.doms.content.html(n(a)),j.bodyUnblur()},v.prototype.renderChannelInfo=function(a){this.doms.topLink.attr("href",a.channel.pageUrl),this.doms.topLink.attr("title",a.channel.title),this.doms.info.prepend(o(a))},c.exports=v}),define("nireader/nireader-fe/2.0.1/template/item/title",["nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/template"),e="<%=item.title%>";c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.1/template/item/info",["nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/template"),e='<span class="mr40">于<%=formatTime(item.pubDate)%></span><a class="mr40" href="<%=item.link%>" target="_blank" title="原文">原文</a>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.1/template/item/content",["nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/template"),e="<%==item.content%>";c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.1/template/item/channelTitle",["nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/template"),e='<span class="">来自<a href="<%=channel.pageUrl%>" title="<%=channel.description%>" data-link-async=true ><%=channel.title%> </a></span>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.1/kit/testScroll",[],function(a,b){b.bottom=function(a){return a=a[0]||a,a&&a.scrollTop+a.clientHeight>=a.scrollHeight},b.top=function(a){return a=a[0]||a,a&&a.scrollTop<=0}}),define("nireader/nireader-fe/2.0.1/module/floater",["nireader/nireader-fe/2.0.1/kit/keypress","nireader/nireader-fe/2.0.1/kit/pattern","nireader/nireader-fe/2.0.1/kit/request","nireader/nireader-fe/2.0.1/kit/resource","nireader/nireader-fe/2.0.1/kit/cache","nireader/nireader-fe/2.0.1/kit/local","nireader/nireader-fe/2.0.1/config","nireader/nireader-fe/2.0.1/kit/url","nireader/nireader-fe/2.0.1/interface/index","nireader/nireader-fe/2.0.1/kit/userinfo","nireader/nireader-fe/2.0.1/kit/cookie","nireader/nireader-fe/2.0.1/kit/notice","nireader/nireader-fe/2.0.1/template/common/notice","nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num","nireader/nireader-fe/2.0.1/kit/effect","nireader/nireader-fe/2.0.1/kit/customEvent","nireader/nireader-fe/2.0.1/template/common/result","nireader/nireader-fe/2.0.1/template/common/tip","nireader/nireader-fe/2.0.1/template/common/loadingIcon"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/kit/keypress"),e=a("nireader/nireader-fe/2.0.1/kit/pattern"),f=a("nireader/nireader-fe/2.0.1/kit/request"),g=a("nireader/nireader-fe/2.0.1/kit/resource"),h=a("nireader/nireader-fe/2.0.1/kit/userinfo"),i=a("nireader/nireader-fe/2.0.1/kit/notice").notice,j=a("nireader/nireader-fe/2.0.1/kit/url"),k=a("nireader/nireader-fe/2.0.1/kit/customEvent"),l=a("nireader/nireader-fe/2.0.1/kit/effect"),m=a("nireader/nireader-fe/2.0.1/kit/cache"),n=a("nireader/nireader-fe/2.0.1/interface/index"),o=n.api,p=n.page,q=a("nireader/nireader-fe/2.0.1/template/common/result"),r=a("nireader/nireader-fe/2.0.1/template/common/tip"),s=a("nireader/nireader-fe/2.0.1/template/common/loadingIcon")();$("#body");var t,u,v,w,x=$("#floater"),y=$("#input"),z=$("#tips"),A=$("#results"),B=function(){t=y.val().trim()},C=function(){y.val("").focus(),W(),z.hide(),A.hide()},D=function(){u||(l.bodyBlur(),x.addClass("show"),C(),B(),u=!0)},E=function(){u&&(l.bodyUnblur(),x.removeClass("show"),u=!1)},F=function(){x.hasClass("show")?E():D()},G=function(){k.trigger("userInfoUpdate")},H=function(){A.html("").hide()},I=function(){z.html("").hide()},J=function(){I(),H()},K=function(a){z.show().prepend(r({tip:{word:a}}))},L=function(a){I(),K(a)},M=function(a,b,c){b=b||"javascript:;";var d=j.isSameDomain(b)?"":"_blank";A.show().append(q({result:{word:a,link:b,target:d,async:c}}))},N=function(a,b){f.post({url:a},o.channel.create,b)},O=function(a,b){f.post({channel:a},o.channel.save,b)},P=function(a,b){f.post({subscribee:a,description:""},o.subscription.add,b)},Q=function(){var a=y.val();L("好像是个rss地址，等我解析下... "+s),N(a,function(b,c){if(a===t){if(J(),b)return L("没解析出来，地址不对。"),void 0;var d=!!c.id;L("用<b>Enter</b>"+(d?"":"添加并")+"订阅"),M(c.title,d?p.channel(c.id):c.link,d),v=function(){O(c,function(a,b){return a?(L("没添加成功。"),void 0):(L(b.title+"添加好了，正在订阅... "+s),P(b.id,function(a){return a?(L("订阅"+b.title+"没成功。"),void 0):(H(),L("订阅了"+b.title+"。"),G(),void 0)}),void 0)})}}})},R=function(){L("按<b>Enter</b>登出。"),v=function(){L("正在登出... "+s),h.logout(function(a){return a?(i("出错了。"),LOG(a),void 0):(location.href=p.home,void 0)})}},S=function(){L("按<b>Enter</b>去首页 ('/')。"),v=function(){L("正在去首页... "+s),k.trigger("goto","/"),I()}},T=function(){L("按<b>Enter</b>清除缓存。"),v=function(){L("正在清除缓存... "+s);var a=m.getSize().MB+"MB";m.clear();var b=m.getSize().MB+"MB";L("缓存已清空。（"+a+"->"+b+"）")}},U=function(a){if(a){for(var b=a.split(" "),c=[],d=0,e=b.length;e>d;d++)b[d]&&c.push(b[d]);if(!c.length)return;g.search("channel",c,1,function(b,c){if(a===t&&!b)for(var d=0,e=c.length;e>d;d++)M(c[d].title,p.channel(c[d].id),!0)})}},V={logout:R,home:S,nocache:T},W=function(){var a=y.val().trim();if(a!=t){if(t=a,J(),a&&V[a])return V[a](),void 0;if(a&&e.url.test(a))return Q(),void 0;var b,c,d;if(a)for(var f in V)V.hasOwnProperty(f)&&(b=f.indexOf(a))>=0&&(d=f,c=f.slice(0,b)+"<b>"+a+"</b>"+f.slice(b+a.length)+"	 ---- 用<b>Tab</b>补全",K(c));w=d&&function(){y.val(d)},U(a)}};y.on("keydown",function(a){9===a.which&&(a.preventDefault(),w&&!w(a))}),y.on("keyup",function(a){return 13===a.which&&v&&!v(a)?(y.val(""),void 0):(W(),void 0)}),d.register(27,function(){F()}),c.exports={visible:function(){return u}}}),define("nireader/nireader-fe/2.0.1/kit/pattern",[],function(a,b,c){var d=/[a-z]+\:\/\/[\w]+\.[\w]+/;c.exports={url:d}}),define("nireader/nireader-fe/2.0.1/template/common/result",["nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/template"),e='<li class="result"><a href="<%=result.link%>" target="<%=result.target%>" <%=result.async?"data-link-async=true":""%>><%==result.word%></a></li>';c.exports=d.compile(e)}),define("nireader/nireader-fe/2.0.1/template/common/tip",["nireader/nireader-fe/2.0.1/template/template","nireader/nireader-fe/2.0.1/kit/time","nireader/nireader-fe/2.0.1/kit/num"],function(a,b,c){var d=a("nireader/nireader-fe/2.0.1/template/template"),e='<li class="tip"><%==tip.word%></li>';c.exports=d.compile(e)});
